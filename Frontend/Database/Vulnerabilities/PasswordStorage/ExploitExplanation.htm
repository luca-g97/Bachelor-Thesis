<!DOCTYPE html>
<html lang="en"><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Add an icon library -->
    <script src="https://unpkg.com/feather-icons"></script>
    <title>Problem</title>
    <style>
        .title{
            background-color: #111111;
            border-radius: 5px;
            padding: 1%;
        }
        body{
            background-color: #222222;
            text-align: center;
            color: lightgrey;
            font-family: 'Open Sans',sans-serif;
        }
        .explanationContainer {
            font-size: 1.3em;
            padding: 1%;
            width: 93%;
            color: lightgrey;
            border: 10px solid #151515;
            border-radius: 5px;
            background-color: #111111
        }
        .explanationInformation{
            font-size: 1.1em;
            color: whitesmoke;
            padding: 1%;
        }
        .explanation{
            font-size: 0.8em;
            background-color: #111111;
            color: lightgrey;
            padding: 2%;
        }
        .information{
            position: relative;
            left: 5%;
            width: 90%;
            text-align: left;
            hyphens: auto;
            word-wrap: break-word;
            letter-spacing: .04em;
        }
        .informationLink{
            color: lightsteelblue;
            font-weight: bold;
        }
        .hackExplanationTip
        {
            padding: 1%;
            border: #999999 solid 3px;
            margin: 2%;
            border-radius: 10px;
        }
        .hackExplanationSolution
        {
            padding: 1%;
            border: lightgrey solid 3px;
            margin: 2%;
            border-radius: 10px;
        }
        .hackExplanationResult
        {
            padding: 1%;
            border: darkorange solid 3px;
            margin: 2%;
            border-radius: 10px; 
        }
        .hackExplanation{
            word-wrap: break-word;
            letter-spacing: .04em;
            align-content: center;
            font-size: 0.9em;
            color: lightgrey;
            white-space: inherit;
            cursor: pointer;
            user-select: none;
            padding: 1%;
        }
        .hackExplanationTip:hover, .hackExplanationSolution:hover, .switchSite:hover{
            background-color: #333333;
        }
        .switchSite {
            opacity: 0.8;
            background-color: black;
            padding: 2%;
            font-size: 0.9em;
            margin: 3%;
            border-radius: 10px;
            cursor: pointer;
            color: whitesmoke;
            font-weight: bold;
            border: 3px solid orangered;
        }
        .feather{
            width: 7%;
            vertical-align: bottom;
            color: lightgrey;
        }
        .feather-right{
            float: right;
            width: 7%;
            vertical-align: bottom;
        }
    </style>
  </head>
  <body>
    <div>
        <h2 id="0" class="title"><br></h2>
        <p id="1" class="information"></p>
                    <div class="explanationContainer">
                        <p id="2" class="explanationInformation"></p>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="6" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="7" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="8" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="9" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="10" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="11" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="12" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationResult"><div class="hackExplanation" id="13" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationResult"><div class="hackExplanation" id="14" ondblclick="showTip(this)"></div></div>
                        <button id="4" class="switchSite" onclick="window.open('../../../CommandProcessor.php?action=ChangeWebsite&website=Database/Vulnerable/Database.htm')"></button>
                        <button id="5" class="switchSite" onclick="window.open('../../../CommandProcessor.php?action=ChangeWebsite&website=Database/Secure/Database.htm')"></button>
                    </div>
                <p id="3" class="information"></p>
              </div>
    <script>
        var german = ["Passwortstärke", "", "<b>Wie kann man diese Lücke nutzen?</b>", "",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE ZU HACKENDE WEBSITE",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE SICHERE WEBSITE",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 1 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 2 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 3 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 1.1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 1.2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 1.3<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 1.4<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Ergebnis 1.1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Ergebnis 1.2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<b>Tipp 1:</b><br><br>Wie werden Passwörter sicher gespeichert?",
            "<b>Tipp 2:</b><br><br>Wo werden Passwörter sicher gespeichert?",
            "<b>Tipp 3:</b><br><br>Wie kommt man an diese verschlüsselten Passwörter heran? Ist es wirklich unmöglich herauszufinden was unverschlüsselt dahintersteckt?",
            "<b>Lösung Schritt 1.1:</b><br><br>Falls Sie sich nicht auf der Database.htm-Seite befinden, gehen Sie dorthin, indem Sie das Folgende in die URL-Suchleiste kopieren: <span style='color: orangered'><b>" + window.location.host + "/Database/Vulnerable/Database.htm</b></span> und im Anschluss <b>Enter</b> drücken. <br><br>Sollten Sie nun nicht direkt in der Datenbank landen, geben Sie bitte das Datenbankpasswort, das Sie zuvor herausgefunden haben ein. <br><br><i>Falls Sie dies noch nicht herausfinden konnten, klicken Sie bitte auf die 2. Sicherheitslücke von links in der Auswahl unten und schauen Sie sich die Hack-Ausführung an. </i><br><br>Andernfalls ist hier noch einmal das Passwort für den Fall dass Sie es vergessen haben sollten: <span style='color: orangered'><b>admin123</b></span>. Drücken Sie im Anschluss <b>Enter</b>",
            "<b>Lösung Schritt 1.2:</b><br><br>Falls die Entwickleroptionen noch nicht geöffnet sind, drücken Sie <b>F12</b> in ihrem Browser um diese zu öffnen",
            "<b>Lösung Schritt 1.3:</b><br><br>Klicken Sie auf den Reiter <b>Webspeicher</b>. Im Anschluss klicken Sie bitte auf <b>Cookies</b> und klicken auf <b>http://" +  window.location.host + "</b>. Kopieren Sie sich den unter <b>Wert</b> stehenden Zahlen-Buchstaben-Mix des Cookies mit dem Namen <b>PasswordVulnerable_1_9_8_2</b>. Dieser müsste wie folgt aussehen: <span style='color: orangered'><b>0192023a7bbd73250516f069df18b500</b></span>",
            "<b>Lösung Schritt 1.4:</b><br><br>Öffnen Sie nun die externe Website <a href='' onclick=\"window.open('https://crackstation.net')\">Crackstation.net</a> indem Sie auf den Link klicken und fügen Sie dort den kopierten Mix ein. Bestätigen Sie im Anschluss, dass sie kein Roboter sind und klicken Sie auf <b>Crack Hashes</b>",
            "<b>Lösung Ergebnis 1.1:</b><br><br>Das Datenbankpasswort liegt nun unverschlüsselt vor Ihnen. Das gleiche Passwort bildet immer denselben Hash, weswegen heutzutage immer komplexere Methoden benötigt werden um Passwörter sicher verschlüsselt zu speichern",
            "<b>Lösung Ergebnis 1.2:</b><br><br>Versuchen Sie dasselbe noch einmal, nachdem Sie durch einen Klick auf den Button <b>Öffne sichere Website</b> die sichere Website geöffnet haben. Kopieren Sie dieses Mal den Wert von Cookie <b>PasswordSecure_1_9_8_2</b> (welcher niemals derselbe ist, sodass ich ihn nicht zur Verfügung stellen kann) und fügen Sie ihn ebenfalls in <a href='' onclick=\"window.open('https://crackstation.net')\">Crackstation.net</a> ein. Sie sehen, dass keiner der Hashtabellen mit Ihrem eingefügten etwas anfangen kann."];

        var english = ["Password Strength", "", "<b>How can this breach be used?</b>", "",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN WEBSITE TO HACK",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN SECURE WEBSITE",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 1 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 2 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 3 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 1.1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 1.2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 1.3<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 1.4<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Result 1.1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Result 1.2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<b>Tip 1:</b><br><br>How are passwords stored safely?",
            "<b>Tip 2:</b><br><br>Where are passwords stored safely?",
            "<b>Tip 3:</b><br><br>How can you get those unencrypted passwords? Is it really impossible to find out what they say decrypted?",
            "<b>Solution Step 1.1:</b><br><br>If you aren´t at the Database.htm webpage, go there by copying the following into the URL search bar:  <span style='color: orangered'><b>" + window.location.host + "/Database/Vulnerable/Database.htm</b></span> and hit <b>Enter</b> afterward. <br><br>If you aren´t redirected directly into the database, please type in the database password you found out earlier. <br><br><i>If you weren´t able to find it out yet, click on the 2nd vulnerability from left in the choice below and have a look at the exploit explanation.</i><br><br> Otherwise here is the password again in case you don´t remember: <span style='color: orangered'><b>admin123</b></span>. Hit <b>Enter</b> afterward", 
            "<b>Solution Step 1.2:</b><br><br>If the developer options aren´t already open, press <b>F12</b> in your browser to open them",
            "<b>Solution Step 1.3:</b><br><br>Change the section by clicking on <b>Webstorage</b>. Click on the left side on <b>Cookies</b> and then on <b>http://" +  window.location.host + "</b>. Copy the mixture of letters and numbers beneath <b>Value</b> of the Cookie with the name <b>PasswordVulnerable_1_9_8_2</b>. This should look like this: <span style='color: orangered'><b>0192023a7bbd73250516f069df18b500</b>",
            "<b>Solution Step 1.4:</b><br><br>Open now the external website <a href='' onclick=\"window.open('https://crackstation.net')\">Crackstation.net</a> by clicking on the link and paste the copied mix in there. Confirm that you are not a robot and click on <b>Crack Hashes</b>",
            "<b>Solution Result 1.1:</b><br><br>The database password is now visibly decrypted in front of you. The same password will always generate the same hash, so nowadays there are way more complex methods needed to ensure safe encrypted storage of passwords",
            "<b>Solution Result 1.2:</b><br><br>Try the same process again after you opened the secure website by clicking on the button <b>Open secure website</b>. Copy this time the value of the cookie <b>PasswordSecure_1_9_8_2</b> (which is never the same so I can´t provide it here) and paste it into <a href='' onclick=\"window.open('https://crackstation.net')\">Crackstation.net</a>. You will see that none of the hashtables can decrypt the one you pasted"];

        var languageToUse = english;
        if (localStorage.getItem("language") === "German")
        {
            languageToUse = german;
        }

        for (var i = 0; i < 15; i++)
        {
            document.getElementById(i.toString()).innerHTML = languageToUse[i];
        }

        //Replace the icons with svgs
        feather.replace();

        var visibleElements = [];
        function showTip(element)
        {
            var index;
            if (!visibleElements.includes(element.id))
            {
                visibleElements.push(element.id);
                index = parseInt(element.id) + 9;
                element.style.textAlign = "left";
                element.style.hyphens = "auto";
                element.style.userSelect = "auto";
                element.style.cursor = "text";
            }
            else
            {
                index = visibleElements.indexOf(element.id);
                visibleElements.splice(index, index+1);
                index = element.id;
                element.style.textAlign = "center";
                element.style.userSelect = "none";
                element.style.cursor = "pointer";
            }
            element.innerHTML = languageToUse[index];
            feather.replace();
        }
    </script>
  </body>
</html>