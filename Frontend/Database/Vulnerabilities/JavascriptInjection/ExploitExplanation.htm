<!DOCTYPE html>
<html lang="en"><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Add an icon library -->
    <script src="https://unpkg.com/feather-icons"></script>
    <title>Problem</title>
    <style>
        .title{
            background-color: #111111;
            border-radius: 5px;
            padding: 1%;
        }
        body{
            background-color: #222222;
            text-align: center;
            color: lightgrey;
            font-family: 'Open Sans',sans-serif;
        }
        .explanationContainer {
            font-size: 1.3em;
            padding: 1%;
            width: 93%;
            color: lightgrey;
            border: 10px solid #151515;
            border-radius: 5px;
            background-color: #111111
        }
        .explanationInformation{
            font-size: 1.1em;
            color: whitesmoke;
            padding: 1%;
        }
        .hackExplanationTip
        {
            padding: 1%;
            border: #999999 solid 3px;
            margin: 2%;
            border-radius: 10px;
        }
        .hackExplanationSolution
        {
            padding: 1%;
            border: lightgrey solid 3px;
            margin: 2%;
            border-radius: 10px;
        }
        .hackExplanationResult
        {
            padding: 1%;
            border: darkorange solid 3px;
            margin: 2%;
            border-radius: 10px; 
        }
        .hackExplanation{
            word-wrap: break-word;
            align-content: center;
            font-size: 0.9em;
            color: lightgrey;
            white-space: inherit;
            cursor: pointer;
            user-select: none;
            padding: 1%;
        }
        .hackExplanationTip:hover, .hackExplanationSolution:hover, .switchSite:hover{
            background-color: #333333;
        }
        .switchSite {
            opacity: 0.8;
            background-color: black;
            padding: 2%;
            font-size: 0.9em;
            margin: 3%;
            border-radius: 10px;
            cursor: pointer;
            color: whitesmoke;
            font-weight: bold;
            border: 3px solid orangered;
        }
        .feather{
            width: 7%;
            vertical-align: bottom;
            color: lightgrey;
        }
        .feather-right{
            float: right;
            width: 7%;
            vertical-align: bottom;
        }
    </style>
  </head>
  <body>
    <div>
        <h2 id="0" class="title"><br></h2>
        <p id="1"></p>
                    <div class="explanationContainer">
                        <p id="2" class="explanationInformation"></p>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="6" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="7" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="8" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="9" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="10" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationResult"><div class="hackExplanation" id="11" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="12" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="13" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationResult"><div class="hackExplanation" id="14" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="15" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="16" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationResult"><div class="hackExplanation" id="17" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationResult"><div class="hackExplanation" id="18" ondblclick="showTip(this)"></div></div>
                        <button id="4" class="switchSite" onclick="window.open('../../../CommandProcessor.php?action=ChangeWebsite&website=Database/Vulnerable/Database.htm')"></button>
                        <button id="5" class="switchSite" onclick="window.open('../../../CommandProcessor.php?action=ChangeWebsite&website=Database/Secure/Database.htm')"></button>
                    </div>
                <p id="3"></p>
              </div>
    <script>
        var german = ["Javascript-Injection", "TEXT", "<b>Wie kann man diese Lücke nutzen?</b>", "TEXT",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE ZU HACKENDE WEBSITE",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE SICHERE WEBSITE",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 1 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 2 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 3 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 1.1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 1.2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Ergebnis 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 2.1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 2.2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Ergebnis 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 3.1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 3.2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Ergebnis 3<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Ergebnis 4<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<b>Tipp 1:</b><br><br>Wie werden auf einer Website Funktionen ausgeführt Besteht eine Website normal nicht nur aus Text?",
            "<b>Tipp 2:</b><br><br>An welcher Stelle kann man Funktionen ausführen?",
            "<b>Tipp 3:</b><br><br>Was ist auf dieser Website bekannt, was ideal zum Einführen eines Javascripts ist?",
            "<b>Lösung Schritt 1.1:</b><br><br>Falls Sie sich nicht auf der Login-Seite der Database.htm-Website befinden, gehen Sie dorthin, indem Sie das Folgende in die URL-Suchleiste kopieren: <span style='color: orangered'><b>" + window.location.host + "/Database/Vulnerable/Database.htm</b></span> und im Anschluss <b>Enter</b> drücken <br><br><i> Falls Sie nicht auf die Login-Seite weitergeleitet werden sollten, öffnen Sie bitte die Entwickleroptionen indem Sie <b>F12</b> drücken und klicken Sie dort auf <b>Webspeicher</b>. Klicken Sie auf <b>Cookies</b> um diesen Abschnitt zu öffnen und führen Sie im Anschluss einen Rechtsklick auf den <b>" + window.location.host + "</b>-Cookie aus. Wählen Sie dort <b>Alles löschen</b> aus und laden Sie im Anschluss die Seite neu indem Sie <b>F5</b> drücken</i>",
            "<b>Lösung Schritt 1.2:</b><br><br>Zunächst führen Sie eine harmlose jedoch nervige permanente Javascript-Injection durch. Dafür kopieren Sie das Folgende in das Eingabefeld auf der Seite, da der Aufbau und Name der Tabelle bekannt ist: <span style='color: orangered'><b>insert into ExampleTable (firstname, lastname, email) values ('" + "&lt" + "script>alert()" + "&lt" + "/script>', 'script', 'alert')</b></span>. Im Anschluss drücken Sie die <b>Enter-Taste</b>",
            "<b>Lösung Result 1:</b><br><br>Sie haben nun erfolgreich Ihre erste Javascript-Injection durchgeführt. Sie sollten nun ein Pop-Up sehen, dass sie mit <b>Ok</b> wegklicken. Laden Sie die Seite neu indem Sie <b>F5</b> drücken. Es wird jedes mal beim Laden der Seite auftauchen, was sehr nervig für jeden Nutzer der Datenbank ist",
            "<b>Lösung Schritt 2.1:</b><br><br>Falls Sie sich nicht auf der Login-Seite der Database.htm-Website befinden, gehen Sie dorthin, indem Sie das Folgende in die URL-Suchleiste kopieren: <span style='color: orangered'><b>" + window.location.host + "/Database/Vulnerable/Database.htm</b></span> und im Anschluss <b>Enter</b> drücken <br><br><i> Falls Sie nicht auf die Login-Seite weitergeleitet werden sollten, öffnen Sie bitte die Entwickleroptionen indem Sie <b>F12</b> drücken und klicken Sie dort auf <b>Webspeicher</b>. Klicken Sie auf <b>Cookies</b> um diesen Abschnitt zu öffnen und führen Sie im Anschluss einen Rechtsklick auf den <b>" + window.location.host + "</b>-Cookie aus. Wählen Sie dort <b>Alles löschen</b> aus und laden Sie im Anschluss die Seite neu indem Sie <b>F5</b> drücken</i>",
            "<b>Lösung Schritt 2.2:</b><br><br>Nun führen Sie eine extrem gefährliche Javascript-Injection für den Erhalt der Cookies des Browser-Fensters durch. Dafür kopieren Sie das Folgende in das Eingabefeld auf der Seite, da der Aufbau und Name der Tabelle bekannt ist: <span style='color: orangered'><b>insert into ExampleTable (firstname, lastname, email) values ('" + "&lt" + "script>console.log(document.cookie)" + "&lt" + "/script>', 'script', 'cookie')</b></span>. Im Anschluss drücken Sie die <b>Enter-Taste</b>",
            "<b>Lösung Lösung 2:</b><br><br>Sie haben nun erfolgreich alle aktuellen Session-Cookies erhalten. Sehen können Sie sie indem Sie mit <b>F12</b> die Entwickleroptionen öffnen und auf den Reiter <b>Konsole</b> klicken. <br><br>Warum dieser Vorgang extrem gefährlich ist können Sie in der Sicherheitslücke <b>Cookie-Diebstahl</b> nachlesen. Dafür klicken Sie in der unteren Auswahl einfach auf die 4. Sicherheitslücke von links",
            "<b>Lösung Schritt 3.1:</b><br><br>Falls Sie sich nicht auf der Login-Seite der Database.htm-Website befinden, gehen Sie dorthin, indem Sie das Folgende in die URL-Suchleiste kopieren: <span style='color: orangered'><b>" + window.location.host + "/Database/Vulnerable/Database.htm</b></span> und im Anschluss <b>Enter</b> drücken <br><br><i> Falls Sie nicht auf die Login-Seite weitergeleitet werden sollten, öffnen Sie bitte die Entwickleroptionen indem Sie <b>F12</b> drücken und klicken Sie dort auf <b>Webspeicher</b>. Klicken Sie auf <b>Cookies</b> um diesen Abschnitt zu öffnen und führen Sie im Anschluss einen Rechtsklick auf den <b>" + window.location.host + "</b>-Cookie aus. Wählen Sie dort <b>Alles löschen</b> aus und laden Sie im Anschluss die Seite neu indem Sie <b>F5</b> drücken</i>",
            "<b>Lösung Schritt 3.2:</b><br><br>Zu guter Letzt führen Sie noch eine Javascript-Injection durch, die die Tabelle sehr unschön aussehen lässt. Dafür kopieren Sie das Folgende in das Eingabefeld auf der Seite, da der Aufbau und Name der Tabelle bekannt ist: <span style='color: orangered'><b>insert into ExampleTable (firstname, lastname, email) values ('" + "&lt" + "iframe src=\"\">', 'iframe', 'iframe')</b></span>. Im Anschluss drücken Sie die <b>Enter-Taste</b>",
            "<b>Lösung Ergebnis 3:</b><br><br>Sie haben nun erfolgreich einen kaputten I-Frame in die Tabelle eingefügt. Kopieren Sie nun das Folgende in das Eingabefeld: <span style='color: orangered'><b>insert into ExampleTable (firstname, lastname, email) values ('test', 'if', 'working')</b></span>. Im Anschluss drücken Sie die <b>Enter-Taste</b>.<br><br> Wie Sie sehen, wird der neue Eintrag nicht mehr angezeigt (In die Datenbank wurde er zwar eingefügt, aber der kaputte I-Frame verhindert, dass die neue Eingabe angezeigt werden kann, da das HTML, das die Tabelle erstellt fehlerhaft ist und somit nicht richtig angezeigt werden kann",
            "<b>Lösung Ergebnis 4:</b><br><br>Versuchen Sie alle 3 Vorgänge zu wiederholen, nachdem Sie durch einen Klick auf den <b>Öffne sichere Website</b>-Button die sichere Website geöffnet haben. <br><br>Sie werden sehen, die Tabelle nimmt die Einträge wie gewünscht auf, es wird keine Konsolen-Ausgabe mehr vorgenommen und es taucht auch kein Popup mehr auf"];

        var english = ["Javascript Injection", "TEXT", "<b>How can this breach be used?</b>", "TEXT",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN WEBSITE TO HACK",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN SECURE WEBSITE",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 1 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 2 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 3 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 1.1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 1.2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Result 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 2.1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 2.2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Result 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 3.1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 3.2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Result 3<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Result 4<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<b>Tip 1:</b><br><br>How are functions executed on a website? Doesn´t a website consist of text only?",
            "<b>Tip 2:</b><br><br>Where on the website can you execute a function?",
            "<b>Tip 3:</b><br><br>What is known on this webpage, which is ideal to inject javascript?",
            "<b>Solution Step 1.1:</b><br><br>If you aren´t at the login webpage of the Database.htm webpage, go there by copying the following in the URL search bar: <span style='color: orangered'><b>" + window.location.host + "/Database/Vulnerable/Database.htm</b></span>> and hit <b>Enter</b> afterward. <br><br><i>If you don´t get redirected to the login webpage, please open the developer options via <b>F12</b> and click on <b>Webstorage</b>. Click on the <b>Cookies</b> section to open and rightclick on the <b>" + window.location.host + "</b> cookie in this section. Finally choose <b>Delete all</b> and reload the page afterward by hitting <b>F5</b></i>",
            "<b>Solution Step 1.2:</b><br><br>First of all you want to do a harmless but annoying javascript injection. To do so, copy the following into the input field, since the structure and the name of the table are known: <span style='color: orangered'><b>insert into ExampleTable (firstname, lastname, email) values ('" + "&lt" + "script>alert()" + "&lt" + "/script>', 'script', 'alert')</b></span>. Hit <b>Enter</b> afterward",
            "<b>Solution Result 1:</b><br><br>You have now successfully done your first javascript injection. You should now see a popup, which you close with <b>Ok</b>. Reload the page by pressing <b>F5</b>. It will appear every time you reload the page which is quite annoying for every user of the database ",
            "<b>Solution Step 2.1:</b><br><br>If you aren´t at the login webpage of the Database.htm webpage, go there by copying the following in the URL search bar: <span style='color: orangered'><b>" + window.location.host + "/Database/Vulnerable/Database.htm</b></span> and hit <b>Enter</b> afterward. <br><br><i>If you don´t get redirected to the login webpage, please open the developer options via <b>F12</b> and click on <b>Webstorage</b>. Click on the <b>Cookies</b> section to open and rightclick on the <b>" + window.location.host + "</b> cookie in this section. Finally choose <b>Delete all</b> and reload the page afterward by hitting <b>F5</b></i>",
            "<b>Solution Step 2.2:</b><br><br>Now we do an extremely dangerous javascript injection to get the cookies of the browser window. To do so, copy the following into the input field, since the structure and the name of the table are visible: <span style='color: orangered'><b>insert into ExampleTable (firstname, lastname, email) values ('" + "&lt" + "script>console.log(document.cookie)" + "&lt" + "/script>', 'script', 'cookie')</b></span>. Hit <b>Enter</b> afterward",
            "<b>Solution Result 2:</b><br><br>You have now successfully got all active session cookies. To see them, open the developer options by pressing <b>F12</b> and switch to the section <b>Console</b>. <br><br>Why this procedure is so dangerous, is explained in the vulnerability <b>Cookie Theft</b>. To go there click the 5th vulnerability from left in the choice beneath",
            "<b>Solution Step 3.1:</b><br><br>If you aren´t at the login webpage of the Database.htm webpage, go there by copying the following in the URL search bar: <span style='color: orangered'><b>" + window.location.host + "/Database/Vulnerable/Database.htm</b></span> and hit <b>Enter</b> afterward. <br><br><i>If you don´t get redirected to the login webpage, please open the developer options via <b>F12</b> and click on <b>Webstorage</b>. Click on the <b>Cookies</b> section to open and rightclick on the <b>" + window.location.host + "</b> cookie in this section. Finally choose <b>Delete all</b> and reload the page afterward by hitting <b>F5</b></i>",
            "<b>Solution Step 3.2:</b><br><br>Last but not least you do a javascript injection which makes the table pretty ugly. To do so, copy the following into the input field, since the structure and the name of the table are visible: <span style='color: orangered'><b>insert into ExampleTable (firstname, lastname, email) values ('" + "&lt" + "iframe src=\"\">', 'iframe', 'iframe')</b></span>. Hit <b>Enter</b> afterward",
            "<b>Solution Result 3:</b><br><br>You successfully added a broken iframe to the table. Copy now the following into the input field: <span style='color: orangered'><b>insert into ExampleTable (firstname, lastname, email) values ('test', 'if', 'working')</b></span>. Hit <b>Enter</b> afterward. <br><br>As you can see, the new entry is not shown anymore (It was still added to the database, but the broken iframe prevents that the new entry can be shown, since the HTML which constructs the table is faulty and so it can´t be shown correctly",
            "<b>Solution Result 4:</b><br><br>Try all 3 procedures again after you opened the secure website by clicking on the <b>Open secure website</b> button. <br><br>You will see, that the table takes the entries as expected and there is no console output and popup anymore"];

        var languageToUse = english;
        if (localStorage.getItem("language") === "German")
        {
            languageToUse = german;
        }

        for (var i = 0; i < 19; i++)
        {
            document.getElementById(i.toString()).innerHTML = languageToUse[i];
        }

        //Replace the icons with svgs
        feather.replace();

        var visibleElements = [];
        function showTip(element)
        {
            var index;
            if (!visibleElements.includes(element.id))
            {
                visibleElements.push(element.id);
                index = parseInt(element.id) + 13;
                element.style.textAlign = "justify";
                element.style.userSelect = "auto";
            }
            else
            {
                index = visibleElements.indexOf(element.id);
                visibleElements.splice(index, index+1);
                index = element.id;
                element.style.textAlign = "center";
                element.style.userSelect = "none";
            }
            element.innerHTML = languageToUse[index];
            feather.replace();
        }
    </script>
  </body>
</html>