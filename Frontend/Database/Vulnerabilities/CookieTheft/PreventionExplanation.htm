<!DOCTYPE html>
<html lang="en"><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Add an icon library -->
    <script src="https://unpkg.com/feather-icons"></script>
    <title>Problem</title>
    <style>
        .title{
            background-color: #111111;
            border-radius: 5px;
            padding: 1%;
        }
        .body{
            background-color: #222222;
            text-align: center;
            color: lightgrey;
            font-family: 'Open Sans',sans-serif;
        }
        .explanationContainer {
            font-size: 1.3em;
            padding: 1%;
            width: 93%;
            color: lightgrey;
            border: 10px solid #151515;
            border-radius: 5px;
            background-color: #111111
        }
        .explanationInformation{
            font-size: 1.1em;
            color: whitesmoke;
            padding: 1%;
        }
        .information{
            position: relative;
            left: 5%;
            width: 90%;
            text-align: left;
            hyphens: auto;
            word-wrap: break-word;
            letter-spacing: .04em;
        }
        .informationLink{
            color: lightsteelblue;
            font-weight: bold;
        }
        .websiteName{
            background-color: black;
            padding: 2%;
            margin: 2%;
            color: darkgrey;
            border-radius: 10px;
        }
        .switchSite:hover{
            background-color: #333333;
        }
        .switchSite {
            opacity: 0.8;
            background-color: black;
            padding: 2%;
            font-size: 0.9em;
            margin: 3%;
            border-radius: 10px;
            cursor: pointer;
            color: whitesmoke;
            font-weight: bold;
            border: 3px solid orangered;
        }
        .feather{
            width: 7%;
            vertical-align: bottom;
            color: dimgrey;
        }
    </style>
</head>
<body class="body">
<div>
    <h2 id="0" class="title"><br></h2>
    <p id="1" class="information"></p>
    <div class="explanationContainer">
        <p id="2" class="explanationInformation"></p>
        <div class="websiteName">Database.php # line68<embed src="../Views/Secure/Database.htm#line67" type="text/html" width="100%" height="100px" style="text-align: left; white-space: normal; text-wrap: none"></div>
        <div class="websiteName"><span style="color: deepskyblue; font-weight: bold">Ideal: Database.php # line121ff</span><embed src="../Views/Secure/Database.htm#line118" type="text/html" width="100%" height="200px" style="text-align: left; white-space: normal; text-wrap: none"></div>
        <div class="websiteName">Database.php # line4020ff<br><span style="color: deepskyblue; font-weight: bold">Ideal: line4024,4028,4030</span><embed src="../Views/Secure/Database.htm#line4019" type="text/html" width="100%" height="200px" style="text-align: left; white-space: normal; text-wrap: none"></div>
        <div class="websiteName">Database.php # line4042ff<embed src="../Views/Secure/Database.htm#line4041" type="text/html" width="100%" height="200px" style="text-align: left; white-space: normal; text-wrap: none"></div>
        <button id="4" class="switchSite" onclick="window.open('../../../CommandProcessor.php?action=ChangeWebsite&website=Database/Secure/Database.htm')"></button>
    </div>
    <p id="3" class="information"></p>
</div>
<script>
    var german = ["Cookie-Diebstahl", "", "<b>Wie kann man diese Lücke bereits vorab verhindern?</b>", "<i class='feather' data-feather='compass' style=\"color: whitesmoke\"></i>&nbsp;&nbsp;&nbsp;<b>Weiterführende Informationen:</b><br><br>Session Management (Sitzungsverwaltung) ist sehr komplex und muss für jeden Nutzungsfall angepasst werden. Allerdings gibt es einige Dinge die immer in Betracht gezogen werden sollten, um Sicherheit zu garantieren. Zunächst einmal sollte die Session-ID (Sitzungsnummer) mindestens 128 Bits haben und von einem kryptographisch sicheren Pseudozufalls-Nummerngenerator (CPSRNG) erstellt werden. Dies garantiert Einzigartigkeit und eine hohe Entropie, sodass Brute-Force (Ausprobieren jeder möglichen Kombination) nicht zu menschlichen Lebzeiten erfolgen kann. Sie darf außerdem keine sensitiven Daten enthalten und lediglich als Identifizierung für den Zugriff genutzt werden.<br><br>Cookies benötigen immer ein aktives Secure-Flag (Sicherheitsfeature das nur aktiviert (1) oder aus (0) sein kann), sodass Webbrowser den Cookie nur HTTPS verschlüsselt versenden und ein Man-in-the-Middle (Abfangen von Informationen auf dem Weg) nicht den unverschlüsselten Cookie erhalten können. Die HTTPOnly-Flag kann nicht wie erwartet Sicherheit gegen jede JavaScript-Attacke gewährleisten, da Client Side Forgery Requests (CSRF) nicht verhindert werden (dies ist jedoch ein schwierigerer Hack), der nur minimiert werden kann durch die Aktivierung des SameSite-Attributs.<br><br>Dennoch verhindert HTTPOnly das Auslesen des Cookies offline, sodass die gängigsten Hacks verhindert werden. Die Domain sollte niemals spezifiziert werden, sodass der Cookie zum Ursprung der Seite geschickt wird. Der Path (Pfad) hingegen sollte angegeben werden, da dadurch sogenannte Cross-Domain-Cookie Attacken verhindert werden, die einen Cookie auf einer Subdomain nutzen wollen. Die Verwendung von nicht dauerhaften Cookies ist ebenfalls vorzuziehen (die vom Browser gelöscht werden wenn er geschlossen wird), um die Zeit zu minimieren, in der ein Hacker den aktiven Cookie stehlen kann <a href='https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html' class='informationLink'>(CheatSheets Series Team, 2021)</a>",
        "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE SICHERE WEBSITE"];

    var english = ["Cookie Theft", "", "<b>How can it be avoided beforehand?</b>", "<i class='feather' data-feather='compass' style=\"color: whitesmoke\"></i>&nbsp;&nbsp;&nbsp;<b>Further Information:</b><br><br>Session Management is highly complex and has to be adapted to each use case, but a few things can always be checked for the assurance of security. First of all the session id should have at least 128 bits which are generated by a “Cryptographically Secure Pseudorandom Number Generator” (CPSRNG), ensuring uniqueness and a high entropy, so brute force won´t work in the lifetime of a human. It also mustn´t include any sensitive data and is only used as identifier to get access to the server side stored data.<br><br>Cookies always need to have the Secure flag activated, so “[web browsers […] only send the cookie through an encrypted HTTPS (SSL/TLS) connection”, so Man-in-the-middle attacks can´t capture the cookie. The HttpOnly flag does not provide security as expected regarding all attacks that include Javascript, so Client Side Forgery Requests can be still done (but is an advanced hack) and must be minimized by using the SameSite attribute. <br><br>HttpOnly only prevents Javascript to extract the cookie values offline, so it still provides prevention to the most common attacks and should therefore be set in any cookie. Domain should never be set, so the cookie is sent to the origin of the domain, but the path should always be specified to stop Cross-Subdomain Cookie exploits, that use a too specific domain to attack the subdomains with the cookie. It is also recommended to use non-persistent cookies (that get deleted after the browser is closed) to minimize the timeframe a hacker can attack the active cookie. <a href='https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html' class='informationLink'>(CheatSheets Series Team, 2021)</a>",
        "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN SECURE WEBSITE"];

    var languageToUse = english;
    if (localStorage.getItem("language") === "German")
    {
        languageToUse = german;
    }

    for (var i = 0; i < 5; i++)
    {
        document.getElementById(i.toString()).innerHTML = languageToUse[i];
    }

    //Replace the icons with svgs
    feather.replace();
</script>
</body>
</html>