<!DOCTYPE html>
<html lang="en"><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Add an icon library -->
    <script src="https://unpkg.com/feather-icons"></script>
    <title>Problem</title>
    <style>
        .title{
            background-color: #111111;
            border-radius: 5px;
            padding: 1%;
        }
        body{
            background-color: #222222;
            text-align: center;
            color: lightgrey;
            font-family: 'Open Sans',sans-serif;
        }
        .explanationContainer {
            font-size: 1.3em;
            padding: 1%;
            width: 93%;
            color: lightgrey;
            border: 10px solid #151515;
            border-radius: 5px;
            background-color: #111111
        }
        .explanationInformation{
            font-size: 1.1em;
            color: whitesmoke;
            padding: 1%;
        }
        .hackExplanationTip
        {
            padding: 1%;
            border: #999999 solid 3px;
            margin: 2%;
            border-radius: 10px;
        }
        .hackExplanationSolution
        {
            padding: 1%;
            border: lightgrey solid 3px;
            margin: 2%;
            border-radius: 10px;
        }
        .hackExplanationResult
        {
            padding: 1%;
            border: darkorange solid 3px;
            margin: 2%;
            border-radius: 10px; 
        }
        .hackExplanation{
            align-content: center;
            font-size: 0.9em;
            color: lightgrey;
            white-space: inherit;
            cursor: pointer;
            user-select: none;
            padding: 1%;
        }
        .hackExplanationTip:hover, .hackExplanationSolution:hover, .switchSite:hover{
            background-color: #333333;
        }
        .switchSite {
            opacity: 0.8;
            background-color: black;
            padding: 2%;
            font-size: 0.9em;
            margin: 3%;
            border-radius: 10px;
            cursor: pointer;
            color: whitesmoke;
            font-weight: bold;
            border: 3px solid orangered;
        }
        .feather{
            width: 7%;
            vertical-align: bottom;
            color: lightgrey;
        }
        .feather-right{
            float: right;
            width: 7%;
            vertical-align: bottom;
        }
    </style>
  </head>
  <body>
    <div>
        <h2 id="0" class="title"><br></h2>
        <p id="1"></p>
                    <div class="explanationContainer">
                        <p id="2" class="explanationInformation"></p>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="6" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="7" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="8" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="9" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="10" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="11" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="12" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationResult"><div class="hackExplanation" id="13" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="14" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationResult"><div class="hackExplanation" id="15" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationResult"><div class="hackExplanation" id="16" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationResult"><div class="hackExplanation" id="17" onclick="showTip(this)"></div></div>
                        <button id="4" class="switchSite" onclick="window.open('../../Vulnerable/Database.htm')"></button>
                        <button id="5" class="switchSite" onclick="window.open('../../Secure/Database.htm')"></button>
                    </div>
                <p id="3"></p>
              </div>
    <script>
        var german = ["Cookie-Diebstahl", "TEXT", "<b>Wie kann man diese Lücke nutzen?</b>", "TEXT",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE ZU HACKENDE WEBSITE",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE SICHERE WEBSITE",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 1 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 2 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 3 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 1.1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 1.2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 1.3<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 1.4<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 1.5<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Ergebnis 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 2.1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Ergebnis 2.1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Ergebnis 2.2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<b>Tipp 1:</b><br><br>Wie speichern Programmierer Login-Daten, sodass Sie sich nicht jedes mal neu einloggen müssen?",
            "<b>Tipp 2:</b><br><br>Wo werden diese Daten gespeichert? Könnten sie vielleicht durch eine Injection an sie herankommen?",
            "<b>Tipp 3:</b><br><br>Was muss zuerst stattfinden bevor ein Cookie erstellt wird?",
            "<b>Lösung Schritt 1.1:</b><br><br>Falls Sie sich nicht auf der Login-Seite der Database.htm-Website befinden, gehen Sie dorthin, indem Sie das Folgende in die URL-Suchleiste kopieren: <br><b>" + window.location.host + "/Database/Vulnerable/Database.htm</b><br> und im Anschluss 'Enter' drücken <br> Falls Sie nicht auf die Login-Seite weitergeleitet werden sollten, öffnen Sie bitte die Entwickleroptionen indem Sie 'F12' drücken und klicken Sie dort auf 'Webspeicher'. Klicken Sie auf 'Cookies' um diesen Abschnitt zu öffenen und führen Sie im Anschluss einen Rechtsklick auf den " + window.location.host + "-Cookie aus. Wählen Sie dort 'Alles löschen' aus und laden Sie im Anschluss die Seite neu indem Sie 'F5' drücken",
            "<b>Lösung Schritt 1.2:</b><br><br>Zunächst müssen Sie sich in die Datenbank einloggen. Dafür geben Sie einfach das zuvor herausgefundene Passwort ein (falls Sie das Datenbankpasswort noch nicht herausgefunden haben, klicken Sie bitte in der unteren Auswahl auf die 3. Sicherheitslücke von links und schauen Sie sich die Hack-Ausführung an). Andernfalls ist hier noch einmal das Passwort falls Sie es nicht mehr wissen sollten: 'admin123'",
            "<b>Lösung Schritt 1.3:</b><br><br>Nach dem Einloggen gehen Sie bitte zurück zur Login-Seite indem Sie einmal auf den 'Zurück'-Button in Ihrem Browser drücken",
            "<b>Lösung Schritt 1.4:</b><br><br>Falls die Entwickleroptionen noch nicht geöffnet sind, drücken Sie 'F12' in ihrem Browser um diese zu öffnen",
            "<b>Lösung Schritt 1.5:</b><br><br>Wechseln Sie per Klick auf den Reiter 'Konsole' in die Javascript-Konsole. <br>Sie müssen zuvor die Javascript-Injection durchgeführt haben, speziell den Abschnitt 'Lösung 3' bevor sie fortfahren. Andernfalls werden Sie keinen Konsoleneintrag vorfinden der die Cookie-ID beinhaltet! (Falls Sie das noch nicht gemacht haben, klicken Sie bitte in der unteren Auswahl auf die 2. Sicherheitslücke von links und schauen Sie sich die Hack-Ausführung an)",
            "<b>Lösung Ergebnis 1:</b><br><br>Sie sollten nun mindestens 2 Cookies sehen. Der erste lautet 'PasswordVulnerable_1_9_8_2 = 0192023a7bbd73250516f069df18b500' und der 2. beinhaltet 'PHPSESSID=' und ein wildes Mix aus Buchstaben und Zahlen dahinter",
            "<b>Lösung Schritt 2.1:</b><br><br>Kopieren Sie sich den kompletten PHP-SessionID-Cookie ('PHPSESSID=' und das Buchstaben-Zahlen-Mix dahinter) und öffnen Sie ein neues Browser-FENSTER! (Rechtsklicken Sie dafür in Ihrer Taskleiste auf das Browsersymbol und klicken Sie auf 'Neues FENSTER öffnen'). Kopieren Sie das folgende dort hinein: <br><b>" + window.location.host + "/Database/Vulnerable/Database.php?</b><br> und kopieren Sie den PHPSESSID-Cookie dahinter. Da die Session-ID niemals die gleiche ist, kann hier nur beispielhaft gezeigt werden wie das Endergebnis aussehen sollte: " + window.location.host + "/Database/Vulnerable/Database.php??PHPSESSID=jojrk1t31n9pvga5knei598bsj <br>Drücken Sie bitte 'Enter' im neu geöffneten Fenster",
            "<b>Lösung Ergebnis 2.1:</b><br><br>Sie haben nun erfolgreich die Datenbank als Admin geöffnet ohne jemals ein Passwort eingegeben zu haben (Sie haben zwar zuvor ein Passwort eingegeben, allerdings war das nur damit eine Session existiert. Das wäre normalerweise der Fall, da auch nur dann Cookies erstellt werden und aktiv sind. Stellen Sie sich das einfach so vor, dass jemand in Indien sich in die Datenbank eingeloggt hat (unser Einloggvorgang) und Sie durch die Kopie der Session-ID seine Sitzung übernommen haben. Sie sind nun also für die Datenbank identisch mit dem Inder und haben auch seine Rechte. In diesem Fall Adminrechte!)",
            "<b>Lösung Ergebnis 2.2:</b><br><br>Versuchen Sie den gleichen Vorgang zu wiederholen, nachdem Sie die sichere Website durch einen Klick auf den 'Öffne sichere Website' Button geöffnet haben. Stellen Sie sicher, dass Sie die Cookies gelöscht haben (führen Sie 'Lösung Schritt 1.1 - 1.2' erneut durch). Wenn Sie nachdem Sie sich in die Datenbank eingeloggt haben einmalig auf den 'Zurück'-Button drücken, werden Sie keine keine Cookies mehr sehen. Das ist auch der Fall wenn Sie das folgende in die Konsole kopieren und im Anschluss 'Enter' drücken: <b>'console.log(document.cookie)'</b>. Versuchen Sie das gleiche nachdem Sie sich eingeloggt haben noch einmal. Die Cookies sind nun nicht mehr für Javascript sichtbar, sodass die nächsten Schritte entfallen"];

        var english = ["Cookie Theft", "TEXT", "<b>How can this breach be used?</b>", "TEXT",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN WEBSITE TO HACK",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN SECURE WEBSITE",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 1 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 2 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 3 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 1.1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 1.2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 1.3<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 1.4<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 1.5<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Result 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 2.1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Result 2.1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Result 2.2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<b>Tip 1:</b><br><br>How do programmers store login data so you don´t have to log in every time?",
            "<b>Tip 2:</b><br><br>Where are those data stored? Can you find them out by injection maybe?",
            "<b>Tip 3:</b><br><br>What needs to be done first before a cookie is created?",
            "<b>Solution Step 1.1:</b><br><br>If you aren´t at the login webpage of the Database.htm webpage, go there by copying the following in the URL search bar: <br><b>" + window.location.host + "/Database/Vulnerable/Database.htm</b><br> and hit 'Enter' afterward. <br>If you don´t get redirected to the login webpage, please open the developer options via 'F12' and click on 'Webstorage'. Click the 'Cookies' section to open and rightclick on the " + window.location.host + " cookie in this section. Finally choose 'Delete all' and reload the page afterward by hitting 'F5'",
            "<b>Solution Step 1.2:</b><br><br>First you have to log in again into the database. So you just take the password you discovered earlier (if you didn´t figure out the database password yet, please click in the choice section underneath on the 3rd from left and have a look at the exploit explanation first). Otherwise here is the password in case you don´t remember: 'admin123'",
            "<b>Solution Step 1.3:</b><br><br>After the login go back to the login page by clicking one time on the back button of your browser",
            "<b>Solution Step 1.4:</b><br><br>If the developer options aren´t already open, press 'F12' in your Browser to open them",
            "<b>Solution Step 1.5:</b><br><br>Change the section by clicking on 'Console'. Now the javascript console is opened. <br>You need to have done the javascript injection, especially the 'Solution Step 3' section before proceeding. Otherwise you won´t have the console log with the cookie id inside of it! (if you haven´t done that yet, please click in the choice section underneath on the 2rd from left and have a look at the exploit explanation first)",
            "<b>Solution Result 1:</b><br><br>You will now see at least 2 cookies. One says 'PasswordVulnerable_1_9_8_2=0192023a7bbd73250516f069df18b500' and the other one includes 'PHPSESSID=' and a mixture of numbers and letters behind it" ,
            "<b>Solution Step 2.1:</b><br><br>Copy the whole php session id ('PHPSESSID=' and the number and letter mixture behind) and open a new browser WINDOW! (rightclick on your browser icon in the taskbar and click 'Open new WINDOW'). Enter the following in there: <br><b>" + window.location.host + "/Database/Vulnerable/Database.php?</b><br> and copy the PHPSESSID cookie behind it. Since this is never the same, I can only give you an example of how it could look like: " + window.location.host + "/Database/Vulnerable/Database.php??PHPSESSID=jojrk1t31n9pvga5knei598bsj <br> Please hit 'Enter' in the opened browser window now",
            "<b>Solution Result 2.1:</b><br><br>You now successfully entered the database as admin without even entering a password (You did enter a password before, but this was only to make sure a session exists. This would be the case in a real hack, since only then cookies are created and active. Just imagine, someone in India has logged into the database (our login process) and you captured the session by copying the session id. You are now identical with this Indian for the database and do have his permissions. In this case admin permissions!)",
            "<b>Solution Result 2.2:</b><br><br>Try the same process after opening the secure website by clicking on the 'Open secure website' button. Make sure you cleared the cookies again (do 'Solution Step 1.1 - 1.2' again to get them cleared). If you log into the database and click the 'back' button in your browser once, you wont be able to get the cookies anymore. This is also the case if you copy the following into the console and hit 'Enter': <b>'console.log(document.cookie)'</b>. Try the same after logging in again. The cookies are now not visible for javascript anymore so we can´t do the next steps anymore"];

        var languageToUse = english;
        if (localStorage.getItem("language") === "German")
        {
            languageToUse = german;
        }

        for (var i = 0; i < 18; i++)
        {
            document.getElementById(i.toString()).innerHTML = languageToUse[i];
        }

        //Replace the icons with svgs
        feather.replace();

        var visibleElements = [];
        function showTip(element)
        {
            var index;
            if (!visibleElements.includes(element.id))
            {
                visibleElements.push(element.id);
                index = parseInt(element.id) + 12;
                element.style.textAlign = "left";
                element.style.userSelect = "auto";
            }
            else
            {
                index = visibleElements.indexOf(element.id);
                visibleElements.splice(index, index+1);
                index = element.id;
                element.style.textAlign = "center";
                element.style.userSelect = "none";
            }
            element.innerHTML = languageToUse[index];
            feather.replace();
        }
    </script>
  </body>
</html>