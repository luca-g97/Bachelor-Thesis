<!DOCTYPE html>
<html lang="en"><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Add an icon library -->
    <script src="https://unpkg.com/feather-icons"></script>
    <title>Problem</title>
    <style>
        .title{
            background-color: #111111;
            border-radius: 5px;
            padding: 1%;
        }
        .body{
            background-color: #222222;
            text-align: center;
            color: lightgrey;
            font-family: 'Open Sans',sans-serif;
        }
        .explanationContainer {
            font-size: 1.3em;
            padding: 1%;
            width: 93%;
            color: lightgrey;
            border: 10px solid #151515;
            border-radius: 5px;
            background-color: #111111
        }
        .explanationInformation{
            font-size: 1.1em;
            color: whitesmoke;
            padding: 1%;
        }
        .explanation{
            font-size: 0.8em;
            background-color: #111111;
            color: lightgrey;
            padding: 2%;
        }
        .information{
            position: relative;
            left: 5%;
            width: 90%;
            text-align: left;
            hyphens: auto;
            word-wrap: break-word;
            letter-spacing: .04em;
        }
        .websiteName{
            background-color: black;
            padding: 2%;
            margin: 2%;
            color: darkgrey;
            border-radius: 10px;
        }
        .switchSite:hover{
            background-color: #333333;
        }
        .switchSite {
            opacity: 0.8;
            background-color: black;
            padding: 2%;
            font-size: 0.9em;
            margin: 3%;
            border-radius: 10px;
            cursor: pointer;
            color: whitesmoke;
            font-weight: bold;
            border: 3px solid orangered;
        }
        .feather{
            width: 7%;
            vertical-align: bottom;
            color: dimgrey;
        }
    </style>
</head>
<body class="body">
<div>
    <h2 id="0" class="title"><br></h2>
    <p id="1" class="information"></p>
    <div class="explanationContainer">
        <p id="2" class="explanationInformation"></p>
        <div class="websiteName">Database.php # line68f<embed src="../Views/Vulnerable/Database.htm#line67" type="text/html" width="100%" height="100px" style="text-align: left; white-space: normal; text-wrap: none"><p id="5" class="explanation"></p></div>
        <div class="websiteName">Database.php # line4023<embed src="../Views/Vulnerable/Database.htm#line4020" type="text/html" width="100%" height="200px" style="text-align: left; white-space: normal; text-wrap: none"><p id="6" class="explanation"></p></div>
        <div class="websiteName">Database.php # line4035ff<embed src="../Views/Vulnerable/Database.htm#line4034" type="text/html" width="100%" height="200px" style="text-align: left; white-space: normal; text-wrap: none"><p id="7" class="explanation"></p></div>
        <button id="4" class="switchSite" onclick="window.open('../../../CommandProcessor.php?action=ChangeWebsite&website=Database/Vulnerable/Database.htm')"></button>
    </div>
    <p id="3" class="information"></p>
</div>
<script>
    var german = ["Cookie-Diebstahl", "", "<b>Welcher Fehler führt zur Sicherheitslücke?</b>", "",
        "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE UNSICHERE WEBSITE", "<i class='feather' data-feather='x-square' style='color: whitesmoke'></i>&nbsp;&nbsp;&nbsp;<b>Wieso ist die markierte Zeile unsicher?</b><br><br>Die ID der Session wird durch den in der URL enthaltenen Parameter PHPSESSID gesetzt. Außerdem wird das Flag (Bit) HttpOnly deaktiviert, sodass alle Cookies in diesem Dokument für Javascript sichtbar sind", "<i class='feather' data-feather='x-square' style='color: whitesmoke'></i>&nbsp;&nbsp;&nbsp;<b>Wieso ist die markierte Zeile unsicher?</b><br><br>Der Cookie wird für immer gültig gesetzt und enthält das verschlüsselte Passwort", "<i class='feather' data-feather='x-square' style='color: whitesmoke'></i>&nbsp;&nbsp;&nbsp;<b>Wieso ist die markierte Zeile unsicher?</b><br><br>Wenn die Session (Sitzung) beendet wird, bleibt der Cookie aktiv"];

    var english = ["Cookie Theft", "", "<b>What error causes the vulnerability?</b>", "",
        "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN VULNERABLE WEBSITE", "<i class='feather' data-feather='x-square' style=\"color: whitesmoke\"></i>&nbsp;&nbsp;&nbsp;<b>Why is the marked line vulnerable?</b><br><br>The id of the session is set by the URL parameter PHPSESSID. Furthermore, the flag HttpOnly is deactivated, so all cookies in this document are visible to Javascript", "<i class='feather' data-feather='x-square' style=\"color: whitesmoke\"></i>&nbsp;&nbsp;&nbsp;<b>Why is the marked line vulnerable?</b><br><br>The cookie is valid forever and includes the encrypted password", "<i class='feather' data-feather='x-square' style=\"color: whitesmoke\"></i>&nbsp;&nbsp;&nbsp;<b>Why is the marked line vulnerable?</b><br><br>When the session is closed, the cookie stays active"];

    var languageToUse = english;
    if (localStorage.getItem("language") === "German")
    {
        languageToUse = german;
    }

    for (var i = 0; i < 8; i++)
    {
        document.getElementById(i.toString()).innerHTML = languageToUse[i];
    }

    //Replace the icons with svgs
    feather.replace();
</script>
</body>
</html>