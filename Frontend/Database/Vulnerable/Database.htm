<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Database</title>
</head>
<!-- Start of my insert -->
<style>
    body{
        margin: 0;
    }
    iframe{
        display: block;
        height: 100vh;
        width: 100vw;
        border: none;
        z-index: 50;
    }
    #explanationOpener {
        opacity: 0.7;
        width: 100px;
        height: 100px;
        z-index: 100;
        position: fixed;
        bottom: 10px;
        right: 10px;
        cursor: pointer;
        border-radius: 2%;
    }
    #explanationCloser {
        width: 1.3%;
        height: 2%;
        min-height: 20px;
        z-index: 100;
        top: 10px;
        left: 100.5%;
        position: fixed;
        color: lightgrey;
        cursor: pointer;
        border: 2px solid lightgrey;
        background-color: black;
        border-radius: 3px;
    }
    #explanation{
        font-size: 0.95em;
        position: fixed;
        background-color: black;
        width: 30%;
        left: 100%;
        height: 100%;
        border: 2px solid black;
        font-family: 'Open Sans',sans-serif;
    }
    .information {
        color: whitesmoke;
        background-color: #111111;
        text-align: center;
        font-weight: bold;
        height: 10%;
        padding: 2%;
    }
    .informationChoice {
        user-select: none;
        padding: 1.7%;
        color: white;
        border: 1px solid #333333;
        width: 33%;
        text-align: center;
        background-color: black;
        cursor: pointer;
        border-radius: 2%;
    }
    .flex-container {
        display: flex;
        flex-wrap: nowrap;
        overflow: auto;
    }
    .flex-item {
        user-select: none;
        flex: 0 0 auto;
        width: 20%;
        height:20%;
        text-align: center;
        vertical-align: middle;
        background-color: black;
        border: 1px solid #333333;
        cursor: pointer;
    }
    .picked {
        background-color: #222222;
    }
    .disclaimer{
        font-family: 'Open Sans',sans-serif;
        text-align: center;
        color: orangered;
        font-size: 1.5em;
        font-weight: bold;
        background-color: #111111
    }
    td:hover, .switchSite:hover, #explanationCloser:hover{
        background-color: #333333;
    }
    #explanationOpener:hover{
        opacity: 1;
    }
    .switchSite {
        padding: 0.5%;
        opacity: 0.8;
        font-size: 1em;
        background-color: black;
        border-radius: 10px;
        cursor: pointer;
        color: whitesmoke;
        font-weight: bold;
        border: 3px solid orangered;
    }
    .feather {
        vertical-align: middle;
    }
</style>
<!-- Need to be called before the elements, so the elements know what to do onclick -->
<script src="https://unpkg.com/feather-icons"></script>
<script>    
    var currentlyPicked = [];

    function showExplanation(element, topic)
    {
        var currentlyClickedVulnerability = element.id;
        //Remove the class picked from the old picked elements
        for (var i = 0; i < currentlyPicked.length; i++)
        {
            if("" !== topic)
            {
                if(!currentlyPicked[i].classList.contains("flex-item"))
                {
                    currentlyPicked[i].classList.remove("picked");
                }
                else
                {
                    currentlyClickedVulnerability = currentlyPicked[i].id;
                }
            }
            else {
                currentlyPicked[i].classList.remove("picked");
            }
        }

        //Add the class picked to the new picked elements
        if(topic === "") {
            document.getElementById("2").classList.add("picked");
            currentlyPicked.push(document.getElementById("2"));
        }
        element.classList.add("picked");
        currentlyPicked.push(element);


        //Set the website source to the picked one
        var newSource = "../Vulnerabilities/" + currentlyClickedVulnerability + "/" + topic + ".htm";
        if(topic === "") {
            newSource = "../Vulnerabilities/" + currentlyClickedVulnerability + "/ExploitExplanation.htm";
        }
        sessionStorage.setItem("OpenedInDatabase", currentlyClickedVulnerability);
        document.getElementById("website").setAttribute("src", newSource);
    }
</script>
<div id="deleteToAvoidDoubling">
<img id="explanationOpener" title="Click here to open&#013 the explanations" onclick="showExplanations(true)" src="../../Logo.png" alt="Click here to open the hacking Explanation">
<i class="feather" data-feather="minimize-2" title="Close Explanation" id="explanationCloser" onclick="showExplanations(false)"></i>
<div id="explanation">
    <div id="choice"><div id="0" class="information"></div>
        <div class="information"><table style="width: 100%"><tr>
            <td id="1" class="informationChoice" style="color: yellow" onclick="showExplanation(this, 'VulnerabilityExplanation')"></td>
            <td id="2" class="informationChoice" onclick="showExplanation(this, 'ExploitExplanation')"></td>
            <td id="3" class="informationChoice" style="color: lawngreen" onclick="showExplanation(this, 'PreventionExplanation')"></td>
        </tr></table></div></div>
    <embed id="website" src="" width="100%" style="background-color: transparent">
    <div id="vulnerabilities"><div id="4" class="information"></div>
        <div class="flex-container"><table style="width:100%"><tr>
            <td id="ErrorMessages" class="flex-item" title="Error Messages" onclick="showExplanation(this, '')"><img src="../../Logo.png" style="width:100px; height:100px"></td>
            <td id="SQLInjection" class="flex-item" title="SQL Injection" onclick="showExplanation(this, '')"><img src="../../Logo.png" style="width:100px; height:100px"></td>
            <td id="JavascriptInjection" class="flex-item" title="Javascript Injection" onclick="showExplanation(this, '')"><img src="../../Logo.png" style="width:100px; height:100px"></td>
            <td id="CookieTheft" class="flex-item" title="CookieTheft" onclick="showExplanation(this, '')"><img src="../../Logo.png" style="width:100px; height:100px"></td>
            <td id="PasswordStorage" class="flex-item" title="Password Storage" onclick="showExplanation(this, '')"><img src="../../Logo.png" style="width:100px; height:100px"></td>
        </tr></table></div></div>
</div>
</div>

<!-- Needs to be called here, because otherwise the elements are not known yet -->
<script>
    var german = ["  Wechseln Sie zwischen den Themen per Klick", "Sicherheitslücke", "Hack-Ausführung", "Verhinderung",
        "Wechseln Sie zwischen den Sicherheitslücken per Klick"];

    var english = ["  Switch between the topics by clicking on the desired", "Vulnerability", "Exploit / Hack", "Prevention",
        "Select the vulnerability by clicking on the button below"];

    var languageToUse = english;
    if (sessionStorage.getItem("language") === "German")
    {
        languageToUse = german;
    }

    for (var i = 0; i < languageToUse.length; i++)
    {
        document.getElementById(i.toString()).innerText = languageToUse[i];
    }
    var tabToOpen = "ErrorMessages";
    if(sessionStorage.getItem("OpenedInDatabase") !== null){
        tabToOpen= sessionStorage.getItem("OpenedInDatabase");
    }
    showExplanation(document.getElementById(tabToOpen), "");
    feather.replace();

    //https://github.com/feathericons/feather/issues/585 -> Showing a title on an feather icon
    Array.from(document.querySelectorAll('svg.feather[title]')).forEach((element) => {
        element.insertAdjacentHTML('afterbegin', `<title>${element.attributes.title.value}</title>`);
    });

    function showExplanations(show) {
        if (show)
        {
            document.getElementById("explanationOpener").style.zIndex = "-100";
            document.getElementById("explanationCloser").style.left = "70.5%";
            document.getElementById("body").style.width = "70%";
            document.getElementById("disclaimer").style.width = "70%";
            document.getElementById("explanation").style.left = "70%";

            var choice = document.getElementById("choice").offsetHeight;
            var vulnerabilities = document.getElementById("vulnerabilities").offsetHeight;
            document.getElementById("website").style.height = document.getElementById("explanation").offsetHeight - document.getElementById("explanation").offsetHeight * 0.01 - choice - vulnerabilities+ "px";
        }
        else
        {
            document.getElementById("explanationOpener").style.zIndex = "100";
            document.getElementById("explanationCloser").style.left = "100.5%";
            document.getElementById("body").style.width = "100%";
            document.getElementById("disclaimer").style.width = "100%";
            document.getElementById("explanation").style.left = "100%";
        }
    }

    //https://web.dev/resize-observer/
    var ro = new ResizeObserver(entries => {
         for (let entry of entries) {
             var choice = document.getElementById("choice").offsetHeight;
             var vulnerabilities = document.getElementById("vulnerabilities").offsetHeight;
             document.getElementById("website").style.height = document.getElementById("explanation").offsetHeight - document.getElementById("explanation").offsetHeight * 0.01 - choice - vulnerabilities+ "px";
         }
    });

    // Observe one or multiple elements
    ro.observe(document.getElementById("explanation"));
</script>
<!-- End of my insert -->
<body>
<div id="disclaimer" class="disclaimer">This website is just a clone for presentation purposes, it is NOT the real one! &nbsp;&nbsp;&nbsp;<button class="switchSite" onclick="window.location.assign('../../../CommandProcessor.php?action=ChangeWebsite&website=/index.htm')"><i class='feather' data-feather='home' style="color: whitesmoke"></i>&nbsp; Home</button></div>
<script>
    feather.replace();     
    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);
    if (urlParams.get("LoggedIn") === "true")
    {
        document.getElementById("deleteToAvoidDoubling").remove();
        document.getElementById("disclaimer").remove();
    }
</script>
<iframe id="body" src="./Database.php"></iframe>
</body>
</html>