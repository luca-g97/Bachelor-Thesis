<!DOCTYPE html>
<html lang="en"><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Add an icon library -->
    <script src="https://unpkg.com/feather-icons"></script>
    <title>Problem</title>
    <style>
        .title{
            background-color: #111111;
            border-radius: 5px;
            padding: 1%;
        }
        body{
            background-color: #222222;
            text-align: center;
            color: lightgrey;
            font-family: 'Open Sans',sans-serif;
        }
        .explanationContainer {
            font-size: 1.3em;
            padding: 1%;
            width: 93%;
            color: lightgrey;
            border: 10px solid #151515;
            border-radius: 5px;
            background-color: #111111
        }
        .explanationInformation{
            font-size: 1.1em;
            color: whitesmoke;
            padding: 1%;
        }
        .hackExplanationTip
        {
            padding: 1%;
            border: #999999 solid 3px;
            margin: 2%;
            border-radius: 10px;
        }
        .hackExplanationSolution
        {
            padding: 1%;
            border: lightgrey solid 3px;
            margin: 2%;
            border-radius: 10px;
        }
        .hackExplanationResult
        {
            padding: 1%;
            border: darkorange solid 3px;
            margin: 2%;
            border-radius: 10px; 
        }
        .hackExplanation{
            word-wrap: break-word;
            letter-spacing: .04em;
            align-content: center;
            font-size: 0.9em;
            color: lightgrey;
            white-space: inherit;
            cursor: pointer;
            user-select: none;
            padding: 1%;
        }
        .hackExplanationTip:hover, .hackExplanationSolution:hover, .switchSite:hover{
            background-color: #333333;
        }
        .switchSite {
            opacity: 0.8;
            background-color: black;
            padding: 2%;
            font-size: 0.9em;
            margin: 3%;
            border-radius: 10px;
            cursor: pointer;
            color: whitesmoke;
            font-weight: bold;
            border: 3px solid orangered;
        }
        .feather{
            width: 7%;
            vertical-align: bottom;
            color: lightgrey;
        }
        .feather-right{
            float: right;
            width: 7%;
            vertical-align: bottom;
        }
    </style>
  </head>
  <body>
    <div>
        <h2 id="0" class="title"><br></h2>
        <p id="1"></p>
                    <div class="explanationContainer">
                        <p id="2" class="explanationInformation"></p>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="6" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="7" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="8" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="9" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="10" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="11" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationResult"><div class="hackExplanation" id="12" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationResult"><div class="hackExplanation" id="13" ondblclick="showTip(this)"></div></div>
                        <button id="4" class="switchSite" onclick="window.open('../../Vulnerable/NetflixUserChoice.htm?u=dGVzdEBiYWM=&p=dGVzdA==')"></button>
                        <button id="5" class="switchSite" onclick="window.open('../../../CommandProcessor.php?action=ChangeWebsite&website=BrokenAccessControl/Secure/NetflixLogin.htm')"></button>
                    </div>
                <p id="3"></p>
              </div>
    <script>
        var german = ["Nutzer-Fehlkonfiguration", "TEXT", "<b>Wie kann man diese Lücke nutzen?</b>", "TEXT",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE ZU HACKENDE WEBSITE",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE SICHERE WEBSITE",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 1 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 2 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 3 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 3<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Ergebnis 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Ergebnis 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<b>Tipp 1:</b><br><br>(Die Aufforderung sich in das gesperrte Verzeichnis einzulocken sollte bereits geöffnet sein. Falls dem nicht der Fall ist, klicken Sie auf die 4. Sicherheitslücke von links in der unteren Auswahl und schauen Sie sich diese Erklärung zuerst an oder klicken Sie direkt auf 'Lösung Schritt 1') auf dieser Seite",
            "<b>Tipp 2:</b><br><br>(Schauen Sie sich zuerst 'Tipp 1' an. Falls dies der Fall sein sollte, fahren Sie fort) Haben Sie bereits Logindaten herausgefunden?",
            "<b>Tipp 3:</b><br><br>(Schauen Sie sich zuerst 'Tipp 1' an. Falls dies der Fall sein sollte, fahren Sie fort) Was könnten Sie verlieren, wenn Sie diese einfach eingeben?",
            "<b>Lösung Schritt 1:</b><br><br>Falls Sie sich nicht auf der NetflixUserChoice.htm-Seite befinden, gehen Sie dorthin, indem Sie das Folgende in die URL-Suchleiste kopieren: <span style='color: orangered'><b>" + window.location.host + "/BrokenAccessControl/Vulnerable/NetflixUserChoice.htm?u=dGVzdEBiYWM=&p=dGVzdA==</b></span> und im Anschluss <b>Enter</b> drücken",
            "<b>Lösung Schritt 2:</b><br><br><i>Falls Sie noch keine Einloggdaten herausgefunden haben, schauen Sie sich dieses bitte zuerst die Hack-Ausführung für Authentifizierung an indem Sie in der unteren Auswahl die 2. Sicherheitslücke von Links anklicken und erst dann weiterlesen</i><br><br>Andernfalls merken Sie sich bitte zunächst die folgenden Daten: <b>Benutzername: test@bac</b> und <b>Passwort: test</b>. Sie werden Sie gleich brauchen<br><br>Kopieren Sie das Folgende in die URL-Suchleiste: <span style='color: orangered'><b>" + window.location.host + "/BrokenAccessControl/Vulnerable/NetflixUserChoice.htm?u=YWRtaW4=&p=YWRtaW4=&check=true</b></span> und drücken Sie im Anschluss <b>Enter</b>. <br><br><i>Falls Sie nicht wissen, wie man auf diese URL kommt, klicken Sie auf die 4. Sicherheitslücke von links in der unteren Auswahl und schauen Sie sich diese Hack-Ausführung zuerst an</i>",
            "<b>Lösung Schritt 3:</b><br><br>Es sollte nun eine Eingabeaufforderung aufgetaucht sein, die sie zum Login in einen gesperrten Bereich auffordert. Geben Sie dort einfach Ihre Test-User-Daten ein. <br><br><i>Falls Sie nicht wissen welche hier gemeint sind, klicken Sie bitte auf die 2. Sicherheitslücke von links in der unteren Auswahl und schauen Sie sich diese Hackausführung zuerst an.</i> <br><br>Andernfalls sind hier noch einmal die Login-Daten, falls Sie sie vergessen haben sollten: <b>Benutzername=<span style='color: orangered'>test@bac</span></b> und das <b>Passwort=<span style='color: orangered'>test</span></b>. Drücken Sie im Anschluss die <b>Enter-Taste</b>",
            "<b>Lösung Ergebnis 1:</b><br><br>Sie sollten nun alle Ordner im sogenannten Root-Verzeichnis (also dem Ursprungsverzeichnis) der Applikation sehen. Dies wäre sozusagen das große Finale bei einem echten Hack und würde unweigerlich im Verlust der Kontrolle über die Applikation enden, wenn der Hacker dies möchte. Es gibt keine Möglichkeit mehr wieder Zugriff zu erlangen, da der Hacker nun Admin-Rechte hat!",
            "<b>Lösung Ergebnis 2:</b><br><br>Versuchen Sie das Folgende, nachdem Sie die sichere Website mit einem Klick auf den Button <b>Öffne sichere Website</b> geöffnet haben. Sie geben nur <span style='color: orangered'><b>admin</b></span> sowohl als Passwort und Benutzernamen auf der NetflixLogin.htm-Seite ein und die Eingabeaufforderung sollte sich öffnen. Sie können nun Ihre Test-Nutzer-Daten eingeben. <br><br><i>Falls Sie diese nicht mehr wissen sollten, klicken Sie auf <b>Lösung Schritt 3</b> um diese noch einmal zu sehen</i>. Drücken Sie im Anschluss <b>Enter</b>. Die Aufforderung wird sich nicht schließen, da Sie nicht die Berechtigung haben als normaler Nutzer den gesperrten Bereich zu sehen!"];

        var english = ["User Misconfiguration", "TEXT", "<b>How can this breach be used?</b>", "TEXT",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN WEBSITE TO HACK",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN SECURE WEBSITE",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 1 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 2 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 3 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 3<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Result 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Result 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<b>Tip 1:</b><br><br>(The prompt for access to forbidden area should be already opened. If not click on the 4th vulnerability from left in the choice below and have a look at the exploit explanation first or advance to 'Solution Step 1' in this topic)",
            "<b>Tip 2:</b><br><br>(Look at 'Tip 1' first. If that is the case go on) Did you find any login data yet?",
            "<b>Tip 3:</b><br><br>(Look at 'Tip 1' first. If that is the case go on) What can you lose by typing them in?",
            "<b>Solution Step 1:</b><br><br>If you aren´t at the NetflixUserChoice.htm webpage, go there by copying the following in the URL search bar: <span style='color: orangered'><b>" + window.location.host + "/BrokenAccessControl/Vulnerable/NetflixUserChoice.htm?u=dGVzdEBiYWM=&p=dGVzdA==</b></span> and hit <b>Enter</b> afterward",
            "<b>Solution Step 2:</b><br><br><i>If you haven´t found any login data, please have a look at the hack explanation of Authentication first by clicking in the choice undernetath on the second vulnerability from left before reading further</i><br><br>Otherwise please remember the following data as you will need it in a second: <b>username: test@bac</b> and <b>password: test</b><br><br>Copy the following in the URL search bar: <span style='color: orangered'><b>" + window.location.host + "/BrokenAccessControl/Vulnerable/NetflixUserChoice.htm?u=YWRtaW4=&p=YWRtaW4=&check=true</b></span> and hit <b>Enter</b> afterward. <br><br><i>If you don't know where this url comes from, click on the 4th vulnerability from left in the choice window beneath and have a look at the exploit explanation first</i>",
            "<b>Solution Step 3:</b><br><br>There should now be a prompt which wants you to log in to get access to the forbidden area. Just type in your test user login data. <br><br><i>If you don't know what is meant, please click on the 2nd vulnerability from left in the choice window beneath and have a look at the exploit explanation first.</i><br><br> Otherwise here is the login data again in case you don't remember it: <b>username=<span style='color: orangered'>test@bac</span></b> and <b>password=<span style='color: orangered'>test</span></b>. Hit <b>Enter</b> afterward.",
            "<b>Solution Result 1:</b><br><br>You are now able to see the root directory (which means the source directory) of the application. This would basically be the final in a real hack and would result in loss of complete control over the application if the hacker wants to. There is no possibility to get the access back again since he has now gained admin permissions!",
            "<b>Solution Result 2:</b><br><br>Try the following after opening the secure website by clicking on the <b>Open secure website</b> button. You just enter <span style='color: orangered'><b>admin</b></span> as username and password at the NetflixLogin.htm website to get the prompt to open. You can now enter your test user credentials. <br><br><i>If you don't know them anymore click on <b>Solution Step 3</b> to see them again</i><br>Hit <b>Enter</b> afterward. The prompt won´t be closed, since you don't have permission as a normal user"];

        var languageToUse = english;
        if (localStorage.getItem("language") === "German")
        {
            languageToUse = german;
        }

        for (var i = 0; i < 14; i++)
        {
            document.getElementById(i.toString()).innerHTML = languageToUse[i];
        }

        //Replace the icons with svgs
        feather.replace();

        var visibleElements = [];
        function showTip(element)
        {
            var index;
            if (!visibleElements.includes(element.id))
            {
                visibleElements.push(element.id);
                index = parseInt(element.id) + 8;
                element.style.textAlign = "left";
                element.style.hyphens = "auto";
                element.style.userSelect = "auto";
                element.style.cursor = "text";
            }
            else
            {
                index = visibleElements.indexOf(element.id);
                visibleElements.splice(index, index+1);
                index = element.id;
                element.style.textAlign = "center";
                element.style.userSelect = "none";
                element.style.cursor = "pointer";
            }
            element.innerHTML = languageToUse[index];
            feather.replace();
        }
    </script>
  </body>
</html>