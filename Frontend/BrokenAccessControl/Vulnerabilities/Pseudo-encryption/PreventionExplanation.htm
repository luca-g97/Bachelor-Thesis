<!DOCTYPE html>
<html lang="en"><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Add an icon library -->
    <script src="https://unpkg.com/feather-icons"></script>
    <title>Problem</title>
    <style>
        .title{
            background-color: #111111;
            border-radius: 5px;
            padding: 1%;
        }
        .body{
            background-color: #222222;
            text-align: center;
            color: lightgrey;
            font-family: 'Open Sans',sans-serif;
        }
        .explanationContainer {
            font-size: 1.3em;
            padding: 1%;
            width: 93%;
            color: lightgrey;
            border: 10px solid #151515;
            border-radius: 5px;
            background-color: #111111
        }
        .explanationInformation{
            font-size: 1.1em;
            color: whitesmoke;
            padding: 1%;
        }
        .explanation{
            font-size: 0.8em;
            background-color: #111111;
            color: lightgrey;
            padding: 2%;
        }
        .information{
            position: relative;
            left: 5%;
            width: 90%;
            text-align: left;
            hyphens: auto;
            word-wrap: break-word;
            letter-spacing: .04em;
        }
        .informationLink{
            color: lightsteelblue;
            font-weight: bold;
        }
        .websiteName{
            background-color: black;
            padding: 2%;
            margin: 2%;
            color: darkgrey;
            border-radius: 10px;
        }
        .switchSite:hover{
            background-color: #333333;
        }
        .switchSite {
            opacity: 0.8;
            background-color: black;
            padding: 2%;
            font-size: 0.9em;
            margin: 3%;
            border-radius: 10px;
            cursor: pointer;
            color: whitesmoke;
            font-weight: bold;
            border: 3px solid orangered;
        }
        .feather{
            width: 7%;
            vertical-align: bottom;
            color: dimgrey;
        }
    </style>
</head>
<body class="body">
<div>
    <h2 id="0" class="title"><br></h2>
    <p id="1" class="information"></p>
    <div class="explanationContainer">
        <p id="2" class="explanationInformation"></p>
        <div class="websiteName">NetflixLogin.htm # line4890<embed src="../Views/Secure/NetflixLogin.htm#line4888" type="text/html" width="100%" height="200px" style="text-align: left; white-space: normal; text-wrap: none"><p id="5" class="explanation"></p></div>
        <div class="websiteName">NetflixUserChoice.htm # line27<embed src="../Views/Secure/NetflixUserChoice.htm#line23" type="text/html" width="100%" height="200px" style="text-align: left; white-space: normal; text-wrap: none"><p id="6" class="explanation"></p></div>
        <div class="websiteName">CommandProcessor.php # line35<embed src="../Views/CommandProcessor.htm#line33" type="text/html" width="100%" height="200px" style="text-align: left; white-space: normal; text-wrap: none"><p id="7" class="explanation"></p></div>
        <button id="4" class="switchSite" onclick="window.open('../../../CommandProcessor.php?action=ChangeWebsite&website=BrokenAccessControl/Secure/NetflixLogin.htm')"></button>
    </div>
    <p id="3" class="information"></p>
</div>
<script>
    var german = ["Pseudoverschlüsselung", "", "<b>Wie kann man diese Lücke bereits vorab verhindern?</b>", "<i class='feather' data-feather='compass' style=\"color: whitesmoke\"></i>&nbsp;&nbsp;&nbsp;<b>Weiterführende Informationen:</b><br><br>Pseudoverschlüsselung ermöglicht Hackern die Durchführung sogenannter Random Number Generator Attacks (zufallsgenerierte Zeichen) <a href='' onclick=\"window.open('https://en.wikipedia.org/wiki/Random_number_generator_attack')\" class='informationLink'>(Wiki, n.d.)</a>, wenn er nicht sicher implementiert ist. Dieser Hack macht exakt was der Name aussagt, nämlich die Aneinanderreihung zufallsgenerierter Ziffern (was hier ein Ansatz wäre, wenn der Algorithmus nicht sichtbar wäre), um unautorisierten Zugang zu einem Account oder Bereich zu erhalten. <a href='' onclick=\"window.open('https://security.snyk.io/vuln/SNYK-JS-KEYPAIR-1730326')\" class='informationLink'>(Synk Limited, 2021)</a>",
        "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE SICHERE WEBSITE", "<i class='feather' data-feather='check-square' style=\"color: whitesmoke\"></i>&nbsp;&nbsp;&nbsp;<b>Was macht die markierte Zeile?</b><br><br>Es wird die Authentifkationsfunktion aus der Loginseite verwendet, die die eingegebenen Daten direkt an den CommandProcessor.php zur Überprüfung weiterleitet, sodass keine Pseudoverschlüsselung mehr notwendig ist", "<i class='feather' data-feather='check-square' style=\"color: whitesmoke\"></i>&nbsp;&nbsp;&nbsp;<b>Was macht die markierte Zeile?</b><br><br>Nichts, die Überprüfung auf den Nutzer-Account wird hier nicht mehr benötigt", "<i class='feather' data-feather='check-square' style=\"color: whitesmoke\"></i>&nbsp;&nbsp;&nbsp;<b>Was macht die markierte Zeile?</b><br><br>Sie überprüft die erhaltenen Daten auf Korrektheit mit den erwarteten Logindaten für den Admin und falls dies der Fall ist erfolgt die Weiterleitung zum Root-Verzeichnis (Wurzelverzeichnis)"];

    var english = ["Pseudo-encryption", "", "<b>How can it be avoided beforehand?</b>", "<i class='feather' data-feather='compass' style=\"color: whitesmoke\"></i>&nbsp;&nbsp;&nbsp;<b>Further Information:</b><br><br>Pseudo encryption also allows hackers random number generator attacks <a href='' onclick=\"window.open('https://en.wikipedia.org/wiki/Random_number_generator_attack')\" class='informationLink'>(Wiki, n.d.)</a>, if not implemented correctly. This is basically exactly what the name says, to connect random generated letters (would be the case in my vulnerability if the method wouldn´t be visible), to gain “authorized access to an account” or area. <a href='' onclick=\"window.open('https://security.snyk.io/vuln/SNYK-JS-KEYPAIR-1730326')\" class='informationLink'>(Synk Limited, 2021)</a>",
        "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN SECURE WEBSITE", "<i class='feather' data-feather='check-square' style=\"color: whitesmoke\"></i>&nbsp;&nbsp;&nbsp;<b>What does the marked line do?</b><br><br>It uses the authentication function which passes the data directly to the CommandProcessor.php to be checked so no Pseudo-encryption is needed anymore", "<i class='feather' data-feather='check-square' style=\"color: whitesmoke\"></i>&nbsp;&nbsp;&nbsp;<b>What does the marked line do?</b><br><br>Nothing, the check for the user account is not needed anymore here", "<i class='feather' data-feather='check-square' style=\"color: whitesmoke\"></i>&nbsp;&nbsp;&nbsp;<b>What does the marked line do?</b><br><br>It checks if the provided data is the correct data expected for the admin and redirects to the root directory then"];

    var languageToUse = english;
    if (sessionStorage.getItem("language") === "German")
    {
        languageToUse = german;
    }

    for (var i = 0; i < 8; i++)
    {
        document.getElementById(i.toString()).innerHTML = languageToUse[i];
    }

    //Replace the icons with svgs
    feather.replace();
</script>
</body>
</html>