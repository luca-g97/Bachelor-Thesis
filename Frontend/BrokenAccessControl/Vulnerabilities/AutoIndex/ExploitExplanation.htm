<!DOCTYPE html>
<html lang="en"><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Add an icon library -->
    <script src="https://unpkg.com/feather-icons"></script>
    <title>Problem</title>
    <style>
        .title{
            background-color: #111111;
            border-radius: 5px;
            padding: 1%;
        }
        body{
            background-color: #222222;
            text-align: center;
            color: lightgrey;
            font-family: 'Open Sans',sans-serif;
        }
        .explanationContainer {
            font-size: 1.3em;
            padding: 1%;
            width: 93%;
            color: lightgrey;
            border: 10px solid #151515;
            border-radius: 5px;
            background-color: #111111
        }
        .explanationInformation{
            font-size: 1.1em;
            color: whitesmoke;
            padding: 1%;
        }
        .hackExplanationTip
        {
            padding: 1%;
            border: #999999 solid 3px;
            margin: 2%;
            border-radius: 10px;
        }
        .hackExplanationSolution
        {
            padding: 1%;
            border: lightgrey solid 3px;
            margin: 2%;
            border-radius: 10px;
        }
        .hackExplanationResult
        {
            padding: 1%;
            border: darkorange solid 3px;
            margin: 2%;
            border-radius: 10px; 
        }
        .hackExplanation{
            align-content: center;
            font-size: 0.9em;
            color: lightgrey;
            white-space: inherit;
            cursor: pointer;
            user-select: none;
            padding: 1%;
        }
        .hackExplanationTip:hover, .hackExplanationSolution:hover, .switchSite:hover{
            background-color: #333333;
        }
        .switchSite {
            opacity: 0.8;
            background-color: black;
            padding: 2%;
            font-size: 0.9em;
            margin: 3%;
            border-radius: 10px;
            cursor: pointer;
            color: whitesmoke;
            font-weight: bold;
            border: 3px solid orangered;
        }
        .feather{
            width: 7%;
            vertical-align: bottom;
            color: lightgrey;
        }
        .feather-right{
            float: right;
            width: 7%;
            vertical-align: bottom;
        }
    </style>
  </head>
  <body>
    <div>
        <h2 id="0" class="title"><br></h2>
        <p id="1"></p>
                    <div class="explanationContainer">
                        <p id="2" class="explanationInformation"></p>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="6" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="7" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="8" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="9" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="10" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="11" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationResult"><div class="hackExplanation" id="12" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationResult"><div class="hackExplanation" id="13" onclick="showTip(this)"></div></div>
                        <button id="4" class="switchSite" onclick="window.open('../../../CommandProcessor.php?action=LoadConfig&securityLevel=Vulnerable')"></button>
                        <button id="5" class="switchSite" onclick="window.open('../../../CommandProcessor.php?action=LoadConfig&securityLevel=Secure')"></button>
                    </div>
                <p id="3"></p>
              </div>
    <script>
        var german = ["Auto-Index für Verzeichnisse", "TEXT", "<b>Wie kann man diese Lücke nutzen?</b>", "TEXT",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE ZU HACKENDE WEBSITE",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE SICHERE WEBSITE",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 1 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 2 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 3 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 3<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Ergebnis 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Ergebnis 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<b>Tipp 1:</b><br><br>Schauen Sie sich die URL an - Was könnten Sie mit ihr anfangen?",
            "<b>Tipp 2:</b><br><br>Wie kommen Sie auf eine neue Seite indem Sie die URL verändern?",
            "<b>Tipp 3:</b><br><br>Versuchen Sie zurück auf die Startseite zu kommen indem Sie die URL anpassen - Was mussten Sie tun um dorthin zu kommen?",
            "<b>Lösung Schritt 1:</b><br><br>Falls Sie sich nicht auf der Netflix.htm-Seite befinden, gehen Sie dorthin, indem Sie das Folgende in die URL-Suchleiste kopieren: <br><b>" + window.location.host + "/BrokenAccessControl/Vulnerable/Netflix.htm</b><br> und im Anschluss 'Enter' drücken",
            "<b>Lösung Schritt 2:</b><br><br>Klicken Sie im Feld, das die URL enthält hinter das letzte Zeichen (m)",
            "<b>Lösung Schritt 3:</b><br><br>Löschen Sie alles von dort aus bis nur noch '" + window.location.host + "/BrokenAccessControl/' im URL-Feld steht. Drücken Sie anschließend die 'Enter' Taste",
            "<b>Lösung Ergebnis 1:</b><br><br>Sie sollten nun alle Ordner im BrokenAccessControl-Verzeichnis sehen. Wenn Autoindex aktiviert ist, ist das überall möglich. Dadurch können Sie die gesamte Verzeichnisstruktur einsehen und vielleicht sogar versteckte oder vergessene Ordner einsehen!",
            "<b>Lösung Ergebnis 2:</b><br><br>Versuchen Sie den gleichen Vorgang zu wiederholen, nachdem Sie die sichere Website über einen Klick auf den Button 'Öffne sichere Website' geöffnet haben. Es wird nicht mehr funktionieren!"];

        var english = ["Auto-Index Directories", "TEXT", "<b>How can this breach be used?</b>", "TEXT",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN WEBSITE TO HACK",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN SECURE WEBSITE",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 1 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 2 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 3 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 3<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Result 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Result 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<b>Tip 1:</b><br><br>Have a look at the URL - what could you do with it?",
            "<b>Tip 2:</b><br><br>How can you get to a new page by changing the URL?",
            "<b>Tip 3:</b><br><br>Try to get back to the start page by changing the url - what did you have to do to get there?",
            "<b>Solution Step 1:</b><br><br>If you aren´t at the Netflix.htm webpage, go there by copying the following in the URL search bar: <br><b>" + window.location.host + "/BrokenAccessControl/Vulnerable/Netflix.htm</b><br> and hit 'Enter' afterward",
            "<b>Solution Step 2:</b><br><br>Click in the field with the URL behind the last letter (m)",
            "<b>Solution Step 3:</b><br><br>Remove everything until it only says '" + window.location.host + "BrokenAccessControl/'. Afterward hit 'Enter'",
            "<b>Solution Result 1:</b><br><br>You are now able to see all the folders inside the directory. If autoindex is activated, this is possible everywhere! You are now able to see the whole folder structure and maybe find hidden or forgotten ones.",
            "<b>Solution Result 2:</b><br><br>Try the same process now after you opened the secure website by clicking on the 'Open secure website' button. It won´t work anymore!"];

        var languageToUse = english;
        if (localStorage.getItem("language") === "German")
        {
            languageToUse = german;
        }

        for (var i = 0; i < 14; i++)
        {
            document.getElementById(i.toString()).innerHTML = languageToUse[i];
        }

        //Replace the icons with svgs
        feather.replace();

        var visibleElements = [];
        function showTip(element)
        {
            var index;
            if (!visibleElements.includes(element.id))
            {
                visibleElements.push(element.id);
                index = parseInt(element.id) + 8;
                element.style.textAlign = "left";
                element.style.userSelect = "auto";
            }
            else
            {
                index = visibleElements.indexOf(element.id);
                visibleElements.splice(index, index+1);
                index = element.id;
                element.style.textAlign = "center";
                element.style.userSelect = "none";
            }
            element.innerHTML = languageToUse[index];
            feather.replace();
        }
    </script>
  </body>
</html>