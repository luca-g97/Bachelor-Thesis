<!DOCTYPE html>
<html lang="en"><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Add an icon library -->
    <script src="https://unpkg.com/feather-icons"></script>
    <title>Problem</title>
    <style>
        .title{
            background-color: #111111;
            border-radius: 5px;
            padding: 1%;
        }
        .body{
            background-color: #222222;
            text-align: center;
            color: lightgrey;
            font-family: 'Open Sans',sans-serif;
        }
        .explanationContainer {
            font-size: 1.3em;
            padding: 1%;
            width: 93%;
            color: lightgrey;
            border: 10px solid #151515;
            border-radius: 5px;
            background-color: #111111
        }
        .explanationInformation{
            font-size: 1.1em;
            color: whitesmoke;
            padding: 1%;
        }
        .explanation{
            font-size: 0.8em;
            background-color: #111111;
            color: lightgrey;
            padding: 2%;
        }
        .information{
            position: relative;
            left: 5%;
            width: 90%;
            text-align: left;
            hyphens: auto;
            word-wrap: break-word;
            letter-spacing: .04em;
        }
        .informationLink{
            color: lightsteelblue;
            font-weight: bold;
        }
        .websiteName{
            background-color: black;
            padding: 2%;
            margin: 2%;
            color: darkgrey;
            border-radius: 10px;
        }
        .switchSite:hover{
            background-color: #333333;
        }
        .switchSite {
            opacity: 0.8;
            background-color: black;
            padding: 2%;
            font-size: 0.9em;
            margin: 3%;
            border-radius: 10px;
            cursor: pointer;
            color: whitesmoke;
            font-weight: bold;
            border: 3px solid orangered;
        }
        .feather{
            width: 7%;
            vertical-align: bottom;
            color: dimgrey;
        }
    </style>
</head>
<body class="body">
<div>
    <h2 id="0" class="title"><br></h2>
    <p id="1" class="information"></p>
    <div class="explanationContainer">
        <p id="2" class="explanationInformation"></p>
        <div class="websiteName">NetflixLogin.htm # line4884ff<embed src="../Views/Vulnerable/NetflixLogin.htm#line4881" type="text/html" width="100%" height="200px" style="text-align: left; white-space: normal; text-wrap: none"><p id="5" class="explanation"></p></div>
        <div class="websiteName">NetflixLogin.htm # line4892f<embed src="../Views/Vulnerable/NetflixLogin.htm#line4890" type="text/html" width="100%" height="200px" style="text-align: left; white-space: normal; text-wrap: none"><p id="6" class="explanation"></p></div>
        <div class="websiteName">NetflixUserChoice.htm # line27ff<embed src="../Views/Vulnerable/NetflixUserChoice.htm#line25" type="text/html" width="100%" height="200px" style="text-align: left; white-space: normal; text-wrap: none"><p id="7" class="explanation"></p></div>
        <div class="websiteName">CommandProcessor.php # line43<embed src="../Views/CommandProcessor.htm#line40" type="text/html" width="100%" height="200px" style="text-align: left; white-space: normal; text-wrap: none"><p id="8" class="explanation"></p></div>
        <button id="4" class="switchSite" onclick="window.open('../../Vulnerable/NetflixUserChoice.htm?u=dGVzdEBiYWM=&p=dGVzdA==')"></button>
    </div>
    <p id="3" class="information"></p>
</div>
<script>
    var german = ["Pseudoverschlüsselung", "", "<b>Welcher Fehler führt zur Sicherheitslücke?</b>", "",
        "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE UNSICHERE WEBSITE", "<i class='feather' data-feather='x-square' style='color: whitesmoke'></i>&nbsp;&nbsp;&nbsp;<b>Wieso ist die markierte Zeile unsicher?</b><br><br>Sie verschlüsselt die eingegebenen Daten mithilfe der Base64-Funktion, was für jeden sichtbar ist", "<i class='feather' data-feather='x-square' style='color: whitesmoke'></i>&nbsp;&nbsp;&nbsp;<b>Wieso ist die markierte Zeile unsicher?</b><br><br>Sie enthält die Login-Daten und fügt die verschlüsselten Eingaben zur URL hinzu", "<i class='feather' data-feather='x-square' style='color: whitesmoke'></i>&nbsp;&nbsp;&nbsp;<b>Wieso ist die markierte Zeile unsicher?</b><br><br>Falls der Parameter check auf 'true' gesetzt ist, werden die Login-Daten an den CommandProcessor.php weitergeleitet, um die Rechte zu überprüfen", "<i class='feather' data-feather='x-square' style='color: whitesmoke'></i>&nbsp;&nbsp;&nbsp;<b>Wieso ist die markierte Zeile unsicher?</b><br><br>Die erhaltenen Daten werden dekodiert mittels Base64-Funktion und falls sie den Admin-Daten entsprechen, wird der Nutzer ins Root-Verzeichnis (Wurzelverzeichnis) weitergeleitet"];

    var english = ["Pseudoencryption", "", "<b>What error causes the vulnerability?</b>", "",
        "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN VULNERABLE WEBSITE", "<i class='feather' data-feather='x-square' style=\"color: whitesmoke\"></i>&nbsp;&nbsp;&nbsp;<b>Why is the marked line vulnerable?</b><br><br>It encodes the inserted data with the base64 function, which is visible to everyone", "<i class='feather' data-feather='x-square' style=\"color: whitesmoke\"></i>&nbsp;&nbsp;&nbsp;<b>Why is the marked line vulnerable?</b><br><br>It includes the expected login data and adds the encoded insertions to the URL", "<i class='feather' data-feather='x-square' style=\"color: whitesmoke\"></i>&nbsp;&nbsp;&nbsp;<b>Why is the marked line vulnerable?</b><br><br>If the parameter check equals 'true' the login data will be passed to the CommandProcessor.php to be checked for permissions", "<i class='feather' data-feather='x-square' style=\"color: whitesmoke\"></i>&nbsp;&nbsp;&nbsp;<b>Why is the marked line vulnerable?</b><br><br>The received data gets decoded with the base64 function and if it equals the admin credentials, a redirect will be done to the root directory"];

    var languageToUse = english;
    if (localStorage.getItem("language") === "German")
    {
        languageToUse = german;
    }

    for (var i = 0; i < 9; i++)
    {
        document.getElementById(i.toString()).innerHTML = languageToUse[i];
    }

    //Replace the icons with svgs
    feather.replace();
</script>
</body>
</html>