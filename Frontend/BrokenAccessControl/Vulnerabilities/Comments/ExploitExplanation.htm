<!DOCTYPE html>
<html lang="en"><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Add an icon library -->
    <script src="https://unpkg.com/feather-icons"></script>
    <title>Problem</title>
    <style>
        .title{
            background-color: #111111;
            border-radius: 5px;
            padding: 1%;
        }
        body{
            background-color: #222222;
            text-align: center;
            color: lightgrey;
            font-family: 'Open Sans',sans-serif;
        }
        .explanationContainer {
            font-size: 1.3em;
            padding: 1%;
            width: 93%;
            color: lightgrey;
            border: 10px solid #151515;
            border-radius: 5px;
            background-color: #111111
        }
        .explanationInformation{
            font-size: 1.1em;
            color: whitesmoke;
            padding: 1%;
        }
        .information{
            position: relative;
            left: 5%;
            width: 90%;
            text-align: left;
            hyphens: auto;
            word-wrap: break-word;
            letter-spacing: .04em;
        }
        .hackExplanationTip
        {
            padding: 1%;
            border: #999999 solid 3px;
            margin: 2%;
            border-radius: 10px;
        }
        .hackExplanationSolution
        {
            padding: 1%;
            border: lightgrey solid 3px;
            margin: 2%;
            border-radius: 10px;
        }
        .hackExplanationResult
        {
            padding: 1%;
            border: darkorange solid 3px;
            margin: 2%;
            border-radius: 10px; 
        }
.hackExplanation{
            word-wrap: break-word;
            letter-spacing: .04em;
            align-content: center;
            font-size: 0.9em;
            color: lightgrey;
            white-space: inherit;
            cursor: pointer;
            user-select: none;
            padding: 1%;
        }
        .hackExplanationTip:hover, .hackExplanationSolution:hover, .switchSite:hover{
            background-color: #333333;
        }
        .switchSite {
            opacity: 0.8;
            background-color: black;
            padding: 2%;
            font-size: 0.9em;
            margin: 3%;
            border-radius: 10px;
            cursor: pointer;
            color: whitesmoke;
            font-weight: bold;
            border: 3px solid orangered;
        }
        .feather{
            width: 7%;
            vertical-align: bottom;
            color: lightgrey;
        }
        .feather-right{
            float: right;
            width: 7%;
            vertical-align: bottom;
        }
    </style>
  </head>
  <body>
    <div>
        <h2 id="0" class="title"><br></h2>
        <p id="1" class="information"></p>
                    <div class="explanationContainer">
                        <p id="2" class="explanationInformation"></p>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="8" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="9" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="10" ondblclick="showTip(this)"></div></div>
                        <div><br></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="11" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="12" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="13" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationResult"><div class="hackExplanation" id="14" ondblclick="showTip(this)"></div></div>
                        <button id="4" class="switchSite" onclick="window.open('../../../CommandProcessor.php?action=ChangeWebsite&website=BrokenAccessControl/Vulnerable/Netflix.htm')"></button>
                        <button id="5" class="switchSite" onclick="window.open('../../../CommandProcessor.php?action=ChangeWebsite&website=BrokenAccessControl/Secure/Netflix.htm')"></button>
                        <div><br></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="15" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="16" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="17" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationResult"><div class="hackExplanation" id="18" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationResult"><div class="hackExplanation" id="19" ondblclick="showTip(this)"></div></div>
                        <button id="6" class="switchSite" onclick="window.open('../../../CommandProcessor.php?action=ChangeWebsite&website=BrokenAccessControl/Vulnerable/NetflixUserChoice.htm')"></button>
                        <button id="7" class="switchSite" onclick="window.open('../../../CommandProcessor.php?action=ChangeWebsite&website=BrokenAccessControl/Secure/NetflixUserChoice.htm')"></button>
                    </div>
                <p id="3" class="information"></p>
              </div>
    <script>
        var german = ["(Vergessene) Kommentare", "", "<b>Wie kann man diese Lücke nutzen?</b>", "",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE ZU HACKENDE WEBSITE",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE SICHERE WEBSITE",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE ZU HACKENDE WEBSITE",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE SICHERE WEBSITE",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 1 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 2 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 3 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 1.1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 1.2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 1.3<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Ergebnis 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 2.1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 2.2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 2.3<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Ergebnis 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Ergebnis 3<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<b>Tipp 1:</b><br><br>Welche Informationen könnten auf der Website enthalten sein, die Ihnen von Nutzen sein können?",
            "<b>Tipp 2:</b><br><br>Was ist unerlässlich für einen Programmierer um später noch seinen eigenen Code zu verstehen?",
            "<b>Tipp 3:</b><br><br>Wie würden Sie einen Kommentar schreiben, der Ihnen sagt, was noch zu tun ist?",
            "<b>Lösung Schritt 1.1:</b><br><br>Falls Sie sich nicht auf der Netflix.htm-Seite befinden, gehen Sie dorthin, indem Sie das Folgende in die URL-Suchleiste kopieren: <span style='color: orangered'><b>" + window.location.host + "/BrokenAccessControl/Vulnerable/Netflix.htm</b></span> und im Anschluss <b>Enter</b> drücken", 
            "<b>Lösung Schritt 1.2:</b><br><br>Falls die Entwickleroptionen noch nicht geöffnet sind, drücken Sie <b>(Fn +) F12</b> in ihrem Browser um diese zu öffnen",
            "<b>Lösung Schritt 1.3:</b><br><br><b>Für Firefox:</b> Im ersten Abschnitt (Inspektor) sehen sie eine Suchleiste in der <b>HTML durchsuchen</b> steht. <br><br><b>Für Chrome:</b>Klicken Sie in den ersten Abschnitt (Elemente) und drücken Sie <b>Strg + F</b>. Nun sehen sie eine Suchleiste in der <b>Nach Zeichenfolge, Selector oder XPath suchen</b> steht. <br><br>Geben Sie dort <span style='color: orangered'><b>ToDo</b></span> ein<br>(<b>Nur für Firefox:</b> und drücken Sie <b>Enter</b>)",
            "<b>Lösung Ergebnis 1:</b><br><br>Ihnen wird nun ein Kommentar angezeigt der Folgendes besagt: <b>ToDo: Check Database for javascript injection possibilities</b>. Sie haben nun die Information erhalten, dass die Datenbank noch nicht auf Javascript-Injection geprüft wurde.",
            "<b>Lösung Schritt 2.1:</b><br><br>Falls Sie sich noch nicht auf der NetflixUserChoice-Seite befinden, gehen Sie dorthin, indem Sie das Folgende in die URL-Suchleiste kopieren: <span style='color: orangered'><b>" + window.location.host + "/BrokenAccessControl/Vulnerable/NetflixUserChoice.htm</b></span> und im Anschluss <b>Enter</b> drücken",
            "<b>Lösung Schritt 2.2:</b><br><br>Falls die Entwickleroptionen noch nicht geöffnet sind, drücken Sie <b>(Fn +) F12</b> in ihrem Browser um diese zu öffnen",
            "<b>Lösung Schritt 2.3:</b><br><br><b>Für Firefox:</b> Im ersten Abschnitt (Inspektor) sehen sie eine Suchleiste in der <b>HTML durchsuchen</b> steht. <br><br><b>Für Chrome:</b> Im ersten Abschnitt (Elemente) drücken Sie <b>Strg + F</b>. Nun sehen sie eine Suchleiste in der <b>Nach Zeichenfolge, Selector oder XPath suchen</b> steht. <br><br> Geben Sie dort <span style='color: orangered'><b>ToDelete</b></span> ein<br>(<b>Nur für Firefox:</b> und drücken Sie <b>Enter</b>)",
            "<b>Lösung Ergebnis 2:</b><br><br>Ihnen wird nun ein Kommentar angezeigt der Folgendes besagt: <b>ToDelete: Authorization possible through change of encoded name - check=true necessary</b>. Sie haben nun die Information erhalten, dass man den Benutzer wechseln kann, indem man die Parameter in der URL ändert und <b>check=true</b> hinzufügt.",
            "<b>Lösung Ergebnis 3:</b><br><br>Versuchen Sie den gleichen Vorgang zu wiederholen, nachdem Sie mit einem Klick auf den Button <b>Öffne sichere Website</b> die sichere Website geöffnet haben. Sie werden die beiden Kommentare nicht mehr vorfinden"];

        var english = ["(Forgotten) Comments", "", "<b>How can this breach be used?</b>", "",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN WEBSITE TO HACK",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN SECURE WEBSITE",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN WEBSITE TO HACK",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN SECURE WEBSITE",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 1 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 2 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 3 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 1.1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 1.2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 1.3<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Result 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 2.1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 2.2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 2.3<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Result 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Result 3<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<b>Tip 1:</b><br><br>What information could the website include which might help you to hack it?",
            "<b>Tip 2:</b><br><br>What is essential for a programmer to understand the code later on",
            "<b>Tip 3:</b><br><br>How would you write a comment, which describes what you still have to do?",
            "<b>Solution Step 1.1:</b><br><br>If you aren´t at the Netflix.htm webpage, go there by copying the following in the URL search bar: <span style='color: orangered'><b>" + window.location.host + "/BrokenAccessControl/Vulnerable/Netflix.htm</b></span> and hit <b>Enter</b> afterward",
            "<b>Solution Step 1.2:</b><br><br>If the developer options aren´t already open, press <b>(Fn +) F12</b> in your Browser to open them",
            "<b>Solution Step 1.3:</b><br><br><b>For Firefox:</b> In the first section you can see a search-bar which says the following: <b>Search HTML</b>. <br><br><b>For Chrome:</b>Click in the first section (Elements) and press <b>Strg + F</b>. You can now see a search-bar which says the following: <b>Find by string, selector or XPath</b>.<br><br>Type <span style='color: orangered'><b>ToDo</b></span> in the field<br>(<b>Only for Firefox:</b> and hit <b>Enter</b>)",
            "<b>Solution Result 1:</b><br><br>Now a comment is shown which says: <b>ToDo: Check Database for javascript injection possibilities</b>. You now have the information that the database isn't checked for javascript injection yet",
            "<b>Solution Step 2.1:</b><br><br>If you aren´t at the NetflixUserChoice.htm webpage, go there by copying the following in the URL search bar: <span style='color: orangered'><b>" + window.location.host + "/BrokenAccessControl/Vulnerable/NetflixUserChoice.htm</b></span> and hit <b>Enter</b> afterward",
            "<b>Solution Step 2.2:</b><br><br>If the developer options aren´t already open, press <b>(Fn +) F12</b> in your Browser to open them",
            "<b>Solution Step 2.3:</b><br><br><b>For Firefox:</b> In the first section you can see a search-bar which says the following: <b>Search HTML</b>. <br><br><b>For Chrome:</b> In the first section (Elements) press <b>Strg + F</b>. You can now see a search-bar which says the following: <b>Find by string, selector or XPath</b>.<br><br> Type <span style='color: orangered'><b>ToDelete</b></span> in the field<br>(<b>Only for Firefox:</b> and hit <b>Enter</b>)",
            "<b>Solution Result 2:</b><br><br>Now a comment is shown which says: <b>ToDelete: Authorization possible through change of encoded name - check=true necessary</b>. You now have the information that the user can be changed by changing the parameters in the url and adding <b>check=true</b>",
            "<b>Solution Result 3:</b><br><br>Try the same process after you opened the secure website by clicking the <b>Open secure website</b> button. You won´t be able to find any of the comments there!"];

        var languageToUse = english;
        if (localStorage.getItem("language") === "German")
        {
            languageToUse = german;
        }

        for (var i = 0; i < 20; i++)
        {
            document.getElementById(i.toString()).innerHTML = languageToUse[i];
        }

        //Replace the icons with svgs
        feather.replace();

        var visibleElements = [];
        function showTip(element)
        {
            var index;
            if (!visibleElements.includes(element.id))
            {
                visibleElements.push(element.id);
                index = parseInt(element.id) + 12;
                element.style.textAlign = "left";
                element.style.userSelect = "auto";
                element.style.cursor = "text";
            }
            else
            {
                index = visibleElements.indexOf(element.id);
                visibleElements.splice(index, index+1);
                index = element.id;
                element.style.textAlign = "center";
                element.style.userSelect = "none";
                element.style.cursor = "pointer";
            }
            element.innerHTML = languageToUse[index];
            feather.replace();
        }
    </script>
  </body>
</html>