<!DOCTYPE html>
<html lang="en"><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Add an icon library -->
    <script src="https://unpkg.com/feather-icons"></script>
    <title>Problem</title>
    <style>
        .title{
            background-color: #111111;
            border-radius: 5px;
            padding: 1%;
        }
        body{
            background-color: #222222;
            text-align: center;
            color: lightgrey;
            font-family: 'Open Sans',sans-serif;
        }
        .explanationContainer {
            font-size: 1.3em;
            padding: 1%;
            width: 93%;
            color: lightgrey;
            border: 10px solid #151515;
            border-radius: 5px;
            background-color: #111111
        }
        .explanationInformation{
            font-size: 1.1em;
            color: whitesmoke;
            padding: 1%;
        }
        .hackExplanationTip
        {
            padding: 1%;
            border: #999999 solid 3px;
            margin: 2%;
            border-radius: 10px;
        }
        .hackExplanationSolution
        {
            padding: 1%;
            border: lightgrey solid 3px;
            margin: 2%;
            border-radius: 10px;
        }
        .hackExplanationResult
        {
            padding: 1%;
            border: darkorange solid 3px;
            margin: 2%;
            border-radius: 10px; 
        }
        .hackExplanation{
            align-content: center;
            font-size: 0.9em;
            color: lightgrey;
            white-space: inherit;
            cursor: pointer;
            user-select: none;
            padding: 1%;
        }
        .hackExplanationTip:hover, .hackExplanationSolution:hover, .switchSite:hover{
            background-color: #333333;
        }
        .switchSite {
            opacity: 0.8;
            background-color: black;
            padding: 2%;
            font-size: 0.9em;
            margin: 3%;
            border-radius: 10px;
            cursor: pointer;
            color: whitesmoke;
            font-weight: bold;
            border: 3px solid orangered;
        }
        .feather{
            width: 7%;
            vertical-align: bottom;
            color: lightgrey;
        }
        .feather-right{
            float: right;
            width: 7%;
            vertical-align: bottom;
        }
    </style>
  </head>
  <body>
    <div>
        <h2 id="0" class="title"><br></h2>
        <p id="1"></p>
                    <div class="explanationContainer">
                        <p id="2" class="explanationInformation"></p>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="6" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="7" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="8" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="9" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="10" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="11" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="12" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="13" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="14" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationResult"><div class="hackExplanation" id="15" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationResult"><div class="hackExplanation" id="16" onclick="showTip(this)"></div></div>
                        <button id="4" class="switchSite" onclick="window.open('../../Vulnerable/NetflixLogin.htm')"></button>
                        <button id="5" class="switchSite" onclick="window.open('../../Secure/NetflixLogin.htm')"></button>
                    </div>
                <p id="3"></p>
              </div>
    <script>
        var german = ["Authentifizierung", "TEXT", "<b>Wie kann man diese Lücke nutzen?</b>", "TEXT",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE ZU HACKENDE WEBSITE",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE SICHERE WEBSITE",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 1 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 2 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 3 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 3<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 4<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 5<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 6<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Ergebnis 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Ergebnis 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<b>Tipp 1:</b><br><br>Welche Informationen auf der Seite können Ihnen von Nutzen sein?",
            "<b>Tipp 2:</b><br><br>Wie könnten Sie versteckte Informationen auffinden",
            "<b>Tipp 3:</b><br><br>Welche Stichworte könnten bei einem Login aufzufinden sein? Was benötigt man immer zwingend?",
            "<b>Lösung Schritt 1:</b><br><br>Falls Sie sich nicht auf der NetflixLogin.htm-Seite befinden, gehen Sie dorthin, indem Sie das Folgende in die URL-Suchleiste kopieren: <br><b>" + window.location.host + "/BrokenAccessControl/Vulnerable/NetflixLogin.htm</b><br> und im Anschluss 'Enter' drücken",
            "<b>Lösung Schritt 2:</b><br><br>Falls die Entwickleroptionen noch nicht geöffnet sind, drücken Sie 'F12' in ihrem Browser um diese zu öffnen",
            "<b>Lösung Schritt 3:</b><br><br>Im ersten Abschnitt (Inspektor) sehen sie eine Suchleiste in der 'HTML durchsuchen' steht. Geben Sie dort 'password' ein und drücken Sie 'Enter'",
            "<b>Lösung Schritt 4:</b><br><br>Sie sollten nun einen Abschnitt angezeigt bekommen, der eine Funktion enthält, die folgende Abfrage beinhaltet: 'if ((userId === \"user@test\") && (password === \"userTest1997\"))...'. Falls nicht, stellen Sie bitte sicher, dass rechts neben der Suchleiste 1/9 angezeigt wird. Sollte dies nicht der Fall sein, drücken Sie solange 'Enter' bis '1/9' angezeigt wird",
            "<b>Lösung Schritt 5:</b><br><br>Klicken Sie nun doppelt auf den Abschnitt um den Text markieren zu können. Kopieren Sie sich nun aus der Funktion zuerst den Benutzernamen, der hinter dem 'userId === ' steht ohne die Anführungszeichen ('user@test'). Fügen Sie diesen in das Feld 'Benutzername' ein",
            "<b>Lösung Schritt 6:</b><br><br>Kopieren Sie sich dann aus der Funktion das Passwort, das hinter dem 'password === ' steht ohne die Anführungszeichen ('userTest1997'). Fügen Sie dieses in das Feld 'Passwort' ein und drücken Sie im Anschluss entweder die 'Enter'-Taste oder den 'login'-Button",
            "<b>Lösung Ergebnis 1:</b><br><br>Es sollte sich nun die Website NetflixUserChoice.htm geöffnet haben",
            "<b>Lösung Ergebnis 2:</b><br><br>Versuchen Sie den gesamten Vorgang noch einmal, nachdem Sie die sichere Seite geöffnet haben indem Sie auf den Button 'Öffne sichere Website' klicken. Sie werden sehen, dass zwar die gleich Funktion vorhanden ist, nun aber die Anmeldedaten nicht mehr in der Seite auffindbar sind!"];

        var english = ["Authentication", "TEXT", "<b>How can this breach be used?</b>", "TEXT",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN WEBSITE TO HACK",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN SECURE WEBSITE",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 1 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 2 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 3 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 3<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 4<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 5<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 6<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Result 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Result 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<b>Tip 1:</b><br><br>Which informations on this page could be useful for you?",
            "<b>Tip 2:</b><br><br>How could you find hidden information?",
            "<b>Tip 3:</b><br><br>Which keywords could you find for a login? What is always necessary?",
            "<b>Solution Step 1:</b><br><br>If you aren´t at the NetflixLogin.htm webpage, go there by copying the following in the URL search bar: <br><b>" + window.location.host + "/BrokenAccessControl/Vulnerable/NetflixLogin.htm</b><br> and hit 'Enter' afterward",
            "<b>Solution Step 2:</b><br><br>If the developer options aren´t already open, press 'F12' in your Browser to open them",
            "<b>Solution Step 3:</b><br><br>In the first section you can see a search-bar which says the following: 'Search HTML'. Type 'password' in the field and hit 'Enter'",
            "<b>Solution Step 4:</b><br><br>You should now see a section which includes a condition that looks like: 'if ((userId === \"user@test\") && (password === \"userTest1997\"))...'. If not, please make sure, that on the right side of the search bar there is a 1/9 visible. If not, please hit 'Enter' until it says '1/9'",
            "<b>Solution Step 5:</b><br><br>Doubleclick on the section to be able to mark the text. Copy now the username which is behind the 'userId === ' without the quotes ('user@test'). Paste this into the username field",
            "<b>Solution Step 6:</b><br><br>Copy the password from the function which is behind the 'password === ' without the quotes ('userTest1997'). Paste it in the password field and hit enter afterward or press the 'login' button",
            "<b>Solution Result 1:</b><br><br>The website NetflixUserChoice.htm should now have opened",
            "<b>Solution Result 2:</b><br><br>Try the same process again after you opened the secure website by clicking on the 'Open secure website' button. You will see that there is the same function visible, but no login data can be found on the site"];

        var languageToUse = english;
        if (localStorage.getItem("language") === "German")
        {
            languageToUse = german;
        }

        for (var i = 0; i < 17; i++)
        {
            document.getElementById(i.toString()).innerHTML = languageToUse[i];
        }

        //Replace the icons with svgs
        feather.replace();

        var visibleElements = [];
        function showTip(element)
        {
            var index;
            if (!visibleElements.includes(element.id))
            {
                visibleElements.push(element.id);
                index = parseInt(element.id) + 11;
                element.style.textAlign = "left";
                element.style.userSelect = "auto";
            }
            else
            {
                index = visibleElements.indexOf(element.id);
                visibleElements.splice(index, index+1);
                index = element.id;
                element.style.textAlign = "center";
                element.style.userSelect = "none";
            }
            element.innerHTML = languageToUse[index];
            feather.replace();
        }
    </script>
  </body>
</html>