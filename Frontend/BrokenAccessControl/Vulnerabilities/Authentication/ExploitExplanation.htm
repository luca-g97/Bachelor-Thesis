<!DOCTYPE html>
<html lang="en"><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Add an icon library -->
    <script src="https://unpkg.com/feather-icons"></script>
    <title>Problem</title>
    <style>
        .title{
            background-color: #111111;
            border-radius: 5px;
            padding: 1%;
        }
        body{
            background-color: #222222;
            text-align: center;
            color: lightgrey;
            font-family: 'Open Sans',sans-serif;
        }
        .explanationContainer {
            font-size: 1.3em;
            padding: 1%;
            width: 93%;
            color: lightgrey;
            border: 10px solid #151515;
            border-radius: 5px;
            background-color: #111111
        }
        .explanationInformation{
            font-size: 1.1em;
            color: whitesmoke;
            padding: 1%;
        }
        .explanation{
            font-size: 0.8em;
            background-color: #111111;
            color: lightgrey;
            padding: 2%;
        }
        .information{
            position: relative;
            left: 5%;
            width: 90%;
            text-align: left;
            hyphens: auto;
            word-wrap: break-word;
            letter-spacing: .04em;
        }
        .informationLink{
            color: lightsteelblue;
            font-weight: bold;
        }
        .hackExplanationTip
        {
            padding: 1%;
            border: #999999 solid 3px;
            margin: 2%;
            border-radius: 10px;
        }
        .hackExplanationSolution
        {
            padding: 1%;
            border: lightgrey solid 3px;
            margin: 2%;
            border-radius: 10px;
        }
        .hackExplanationResult
        {
            padding: 1%;
            border: darkorange solid 3px;
            margin: 2%;
            border-radius: 10px; 
        }
        .hackExplanation{
            word-wrap: break-word;
            letter-spacing: .04em;
            align-content: center;
            font-size: 0.9em;
            color: lightgrey;
            white-space: inherit;
            cursor: pointer;
            user-select: none;
            padding: 1%;
        }
        .hackExplanationTip:hover, .hackExplanationSolution:hover, .switchSite:hover{
            background-color: #333333;
        }
        .switchSite {
            opacity: 0.8;
            background-color: black;
            padding: 2%;
            font-size: 0.9em;
            margin: 3%;
            border-radius: 10px;
            cursor: pointer;
            color: whitesmoke;
            font-weight: bold;
            border: 3px solid orangered;
        }
        .feather{
            width: 7%;
            vertical-align: bottom;
            color: lightgrey;
        }
        .feather-right{
            float: right;
            width: 7%;
            vertical-align: bottom;
        }
    </style>
  </head>
  <body>
    <div>
        <h2 id="0" class="title"><br></h2>
        <p id="1" class="information"></p>
                    <div class="explanationContainer">
                        <p id="2" class="explanationInformation"></p>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="6" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="7" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="8" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="9" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="10" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="11" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="12" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="13" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="14" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationResult"><div class="hackExplanation" id="15" ondblclick="showTip(this)"></div></div>
                        <div class="hackExplanationResult"><div class="hackExplanation" id="16" ondblclick="showTip(this)"></div></div>
                        <button id="4" class="switchSite" onclick="window.open('../../Vulnerable/NetflixLogin.htm')"></button>
                        <button id="5" class="switchSite" onclick="window.open('../../Secure/NetflixLogin.htm')"></button>
                    </div>
                <p id="3" class="information"></p>
              </div>
    <script>
        var german = ["Authentifizierung", "", "<b>Wie kann man diese Lücke nutzen?</b>", "",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE ZU HACKENDE WEBSITE",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE SICHERE WEBSITE",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 1 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 2 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 3 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 3<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 4<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 5<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 6<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Ergebnis 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Ergebnis 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<b>Tipp 1:</b><br><br>Welche Informationen auf der Seite können Ihnen von Nutzen sein?",
            "<b>Tipp 2:</b><br><br>Wie könnten Sie versteckte Informationen auffinden",
            "<b>Tipp 3:</b><br><br>Welche Stichworte könnten bei einem Login aufzufinden sein? Was benötigt man immer zwingend?",
            "<b>Lösung Schritt 1:</b><br><br>Falls Sie sich nicht auf der NetflixLogin.htm-Seite befinden, gehen Sie dorthin, indem Sie das Folgende in die URL-Suchleiste kopieren: <span style='color: orangered'><b>" + window.location.host + "/BrokenAccessControl/Vulnerable/NetflixLogin.htm</b></span> und im Anschluss <b>Enter</b> drücken",
            "<b>Lösung Schritt 2:</b><br><br>Falls die Entwickleroptionen noch nicht geöffnet sind, drücken Sie <b>(Fn +) F12</b> in ihrem Browser um diese zu öffnen",
            "<b>Lösung Schritt 3:</b><br><br>Im ersten Abschnitt (Inspektor) sehen sie eine Suchleiste in der <b>HTML durchsuchen</b> steht. Geben Sie dort <span style='color: orangered'><b>password'</b></span> ein und drücken Sie <b>Enter</b>",
            "<b>Lösung Schritt 4:</b><br><br>Sie sollten nun einen Abschnitt angezeigt bekommen, der eine Funktion enthält, die folgende Abfrage beinhaltet: <b>if ((userId === \"test@bac\") && (password === \"test\"))</b>. <br><br><i>Falls nicht, stellen Sie bitte sicher, dass rechts neben der Suchleiste <b>1/9</b> angezeigt wird. Sollte dies nicht der Fall sein, drücken Sie solange <b>Enter</b> bis <b>1/9</b> angezeigt wird</i>",
            "<b>Lösung Schritt 5:</b><br><br>Klicken Sie nun doppelt auf den Abschnitt um den Text markieren zu können. Kopieren Sie sich nun aus der Funktion zuerst den Benutzernamen, der hinter dem <b>userId === </b> steht ohne die Anführungszeichen (<span style='color: orangered'><b>test@bac</b></span>). Fügen Sie diesen in das Feld <b>Benutzername</b> ein",
            "<b>Lösung Schritt 6:</b><br><br>Kopieren Sie sich dann aus der Funktion das Passwort, das hinter dem <b>password === </b> steht ohne (<span style='color: orangered'><b>test</b></span>). Fügen Sie dieses in das Feld <b>Passwort</b> ein und drücken Sie im Anschluss entweder die <b>Enter-Taste</b> oder den <b>Login-Button</b>",
            "<b>Lösung Ergebnis 1:</b><br><br>Es sollte sich nun die Website NetflixUserChoice.htm geöffnet haben",
            "<b>Lösung Ergebnis 2:</b><br><br>Versuchen Sie den gesamten Vorgang noch einmal, nachdem Sie die sichere Seite geöffnet haben, indem Sie auf den Button <b>Öffne sichere Website</b> klicken. Sie werden sehen, dass zwar die gleiche Funktion vorhanden ist, nun aber die Anmeldedaten nicht mehr in der Seite auffindbar sind"];

        var english = ["Authentication", "", "<b>How can this breach be used?</b>", "",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN WEBSITE TO HACK",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN SECURE WEBSITE",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 1 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 2 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 3 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 3<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 4<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 5<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 6<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Result 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Result 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<b>Tip 1:</b><br><br>Which informations on this page could be useful for you?",
            "<b>Tip 2:</b><br><br>How could you find hidden information?",
            "<b>Tip 3:</b><br><br>Which keywords could you find for a login? What is always necessary?",
            "<b>Solution Step 1:</b><br><br>If you aren´t at the NetflixLogin.htm webpage, go there by copying the following in the URL search bar: <span style='color: orangered'><b>" + window.location.host + "/BrokenAccessControl/Vulnerable/NetflixLogin.htm</b></span> and hit <b>Enter</b> afterward",
            "<b>Solution Step 2:</b><br><br>If the developer options aren´t already open, press <b>(Fn +) F12</b> in your Browser to open them",
            "<b>Solution Step 3:</b><br><br>In the first section you can see a search-bar which says: <b>Search HTML</b>. Type <span style='color: orangered'><b>password</b></span> in the field and hit <b>Enter'</b>",
            "<b>Solution Step 4:</b><br><br>You should now see a section which includes a condition that looks like: <b>if ((userId === \"test@bac\") && (password === \"test\"))</b>. <br><br><i>If not, please make sure, that on the right side of the search bar there is a <b>1/9</b> visible. If not, please hit <b>Enter</b> until it says <b>1/9</b></i>",
            "<b>Solution Step 5:</b><br><br>Double click on the section to be able to mark the text. Copy now the username which is behind the <b>userId === </b> (<span style='color: orangered'><b>test@bac</b></span>). Paste this into the <b>username</b> field",
            "<b>Solution Step 6:</b><br><br>Copy the password from the function which is behind the <b>password === </b> (<span style='color: orangered'><b>test</b></span>). Paste it in the <b>password</b> field and hit <b>Enter</b> afterward or press the <b>Login</b> button",
            "<b>Solution Result 1:</b><br><br>The website NetflixUserChoice.htm should now have opened",
            "<b>Solution Result 2:</b><br><br>Try the same process again after you opened the secure website by clicking on the <b>Open secure website</b> button. You will see that there is the same function visible, but no login data can be found on the site"];

        var languageToUse = english;
        if (localStorage.getItem("language") === "German")
        {
            languageToUse = german;
        }

        for (var i = 0; i < 17; i++)
        {
            document.getElementById(i.toString()).innerHTML = languageToUse[i];
        }

        //Replace the icons with svgs
        feather.replace();

        var visibleElements = [];
        function showTip(element)
        {
            var index;
            if (!visibleElements.includes(element.id))
            {
                visibleElements.push(element.id);
                index = parseInt(element.id) + 11;
                element.style.textAlign = "left";
element.style.hyphens = "auto";
                element.style.userSelect = "auto";
                element.style.cursor = "text";
            }
            else
            {
                index = visibleElements.indexOf(element.id);
                visibleElements.splice(index, index+1);
                index = element.id;
                element.style.textAlign = "center";
                element.style.userSelect = "none";
                element.style.cursor = "pointer";
            }
            element.innerHTML = languageToUse[index];
            feather.replace();
        }
    </script>
  </body>
</html>