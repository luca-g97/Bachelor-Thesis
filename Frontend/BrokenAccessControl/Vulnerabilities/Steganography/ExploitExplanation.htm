<!DOCTYPE html>
<html lang="en"><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Add an icon library -->
    <script src="https://unpkg.com/feather-icons"></script>
    <title>Problem</title>
    <style>
        .title{
            background-color: #111111;
            border-radius: 5px;
            padding: 1%;
        }
        body{
            background-color: #222222;
            text-align: center;
            color: lightgrey;
            font-family: 'Open Sans',sans-serif;
        }
        .explanationContainer {
            font-size: 1.3em;
            padding: 1%;
            width: 93%;
            color: lightgrey;
            border: 10px solid #151515;
            border-radius: 5px;
            background-color: #111111
        }
        .explanationInformation{
            font-size: 1.1em;
            color: whitesmoke;
            padding: 1%;
        }
        .hackExplanationTip
        {
            padding: 1%;
            border: #999999 solid 3px;
            margin: 2%;
            border-radius: 10px;
        }
        .hackExplanationSolution
        {
            padding: 1%;
            border: lightgrey solid 3px;
            margin: 2%;
            border-radius: 10px;
        }
        .hackExplanationResult
        {
            padding: 1%;
            border: darkorange solid 3px;
            margin: 2%;
            border-radius: 10px; 
        }
        .hackExplanation{
            align-content: center;
            font-size: 0.9em;
            color: lightgrey;
            white-space: inherit;
            cursor: pointer;
            user-select: none;
            padding: 1%;
        }
        .hackExplanationTip:hover, .hackExplanationSolution:hover, .switchSite:hover{
            background-color: #333333;
        }
        .switchSite {
            opacity: 0.8;
            background-color: black;
            padding: 2%;
            font-size: 0.9em;
            margin: 3%;
            border-radius: 10px;
            cursor: pointer;
            color: whitesmoke;
            font-weight: bold;
            border: 3px solid orangered;
        }
        .feather{
            width: 7%;
            vertical-align: bottom;
            color: lightgrey;
        }
        .feather-right{
            float: right;
            width: 7%;
            vertical-align: bottom;
        }
    </style>
  </head>
  <body>
    <div>
        <h2 id="0" class="title"><br></h2>
        <p id="1"></p>
                    <div class="explanationContainer">
                        <p id="2" class="explanationInformation"></p>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="6" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="7" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationTip"><div class="hackExplanation" id="8" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="9" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="10" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="11" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="12" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="13" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="14" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="15" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationSolution"><div class="hackExplanation" id="16" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationResult"><div class="hackExplanation" id="17" onclick="showTip(this)"></div></div>
                        <div class="hackExplanationResult"><div class="hackExplanation" id="18" onclick="showTip(this)"></div></div>
                        <button id="4" class="switchSite" onclick="window.open('../../Vulnerable/NetflixUserChoice.htmu=dXNlckB0ZXN0&p=dXNlclRlc3QxOTk3')"></button>
                        <button id="5" class="switchSite" onclick="window.open('../../Secure/NetflixLogin.htm')"></button>
                    </div>
                <p id="3"></p>
              </div>
    <script>
        var german = ["Steganografie (Pseudoverschlüsselung)", "TEXT", "<b>Wie kann man diese Lücke nutzen?</b>", "TEXT",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE ZU HACKENDE WEBSITE",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp ÖFFNE SICHERE WEBSITE",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 1 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 2 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tipp 3 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 3<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 4<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 5<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 6<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 7<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Schritt 8<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Ergebnis 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Lösung Ergebnis 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<b>Tipp 1:</b><br><br>Schauen Sie sich die URL an - Was könnten Sie mit ihr anfangen?",
            "<b>Tipp 2:</b><br><br>Sagen Ihnen die kryptischen Zeichenketten in der URL etwas?",
            "<b>Tipp 3:</b><br><br>Fallen Ihnen Gemeinsamkeiten an den kryptischen Ketten auf? Falls ja, erinnern diese sie an etwas?",
            "<b>Lösung Schritt 1:</b><br><br>Falls Sie sich nicht auf der NetflixUserChoice.htm-Seite befinden, gehen Sie dorthin, indem Sie das Folgende in die URL-Suchleiste kopieren: <br><b>" + window.location.host + "/BrokenAccessControl/Vulnerable/NetflixUserChoice.htm?u=dXNlckB0ZXN0&p=dXNlclRlc3QxOTk3</b><br> und im Anschluss 'Enter' drücken",
            "<b>Lösung Schritt 2:</b><br><br>Falls die Entwickleroptionen noch nicht geöffnet sind, drücken Sie 'F12' in ihrem Browser um diese zu öffnen",
            "<b>Lösung Schritt 3:</b><br><br>Wechseln Sie per Klick auf den Reiter 'Konsole' in die Javascript-Konsole. Schreiben Sie 'atob(\"\")' dort hinein (Das ist die Javascript-Funktion zum Dekodieren eines Base64-Codes)",
            "<b>Lösung Schritt 4:</b><br><br>Kopieren Sie den Abschnitt der URL zwischen dem 'u=' und dem '&p=' in die Klammern der 'atob'-Funktion<br>Es müsste nun 'atob(\"dXNlckB0ZXN0\")' in der Konsole stehen. Drücken Sie im Anschluss die 'Enter'-Taste. <br>Sie sehen nun in Klarschrift den Nutzernamen der in der URL verschlüsselt wurde.",
            "<b>Lösung Schritt 5:</b><br><br>Führen Sie das gleiche noch einmal mit dem Abschnitt nach dem 'p=' durch<br>Die fertige Funktion sieht dann so aus: 'atob(\"dXNlclRlc3QxOTk3\")'. Drücken Sie im Anschluss die 'Enter'-Taste.<br>Nun sehen Sie das Passwort klar und deutlich vor sich. Bevor Sie den nächsten Hinweis öffnen überlegen Sie bitte kurz. Wie könnten Sie sich nun als Admin anmelden?",
            "<b>Lösung Schritt 6:</b><br><br>Falls Sie sich gedacht haben 'admin' in die 'btoa'-Funktion (der Funktion zum Verschlüsseln von Texten mithilfe von Base64) einzugeben, haben Sie alles richtig gemacht - Respekt!",
            "<b>Lösung Schritt 7:</b><br><br>Geben Sie nun also '<b>btoa(\"admin\")</b>' in der Konsole ein. Sie erhalten folgende Ausgabe: 'YWRtaW4='. Dies ist die Base64 verschlüsselte Version von 'admin'",
            "<b>Lösung Schritt 8:</b><br><br>Fügen Sie die Base64 verschlüsselte Version von 'admin' nun anstelle des kryptischen Parts hinter 'u=' ein, ebenso wie hinter 'p='. Wie wir in der Sicherheitslücke '(Vergessene) Kommentare' gelernt haben, müssen wir nun nur noch ein '&check=true' anfügen.<br> Die gesamte URL sollte damit wie folgt aussehen: <br><b>'" + window.location.host + "/BrokenAccessControl/Vulnerable/NetflixUserChoice.htm?u=YWRtaW4=&p=YWRtaW4=&check=true'</b>",
            "<b>Lösung Ergebnis 1:</b><br><br>Es sollte nun eine Aufforderung auftauchen, sich anzumelden um in den gesperrten Bereich zu kommen. Diese taucht auch auf wenn Sie nach dem Wechsel auf die sichere Website, durch einen Klick auf den Button 'Öffne sichere Website' auf der NetflixLogin.htm-Seite als Benutzernamen 'admin' und als Passwort ebenfalls 'admin' eingeben. Im Anschluss müssen Sie nun nur noch 'Enter' drücken oder auf den 'login'-Button klicken",
            "<b>Lösung Ergebnis 2:</b><br><br>Ab hier geht es um die Sicherheitslücke 'Nutzer-Fehlkonfiguration'. Falls Sie mit der Ausnutzung der Sicherheitslücke fortfahren wollen, klicken Sie nun im Auswahlfenster unten auf die 5. Sicherheitslücke von links und fahren Sie mit Lösung 3 fort."];

        var english = ["Steganography (Pseudoencryption)", "TEXT", "<b>How can this breach be used?</b>", "TEXT",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN WEBSITE TO HACK",
            "<i class='feather' data-feather='external-link' style=\"color: whitesmoke\"></i> &nbsp OPEN SECURE WEBSITE",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 1 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 2 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'help-circle\'></i> &nbsp Tip 3 <i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 1<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 3<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 4<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 5<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 6<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 7<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Step 8<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Result 1)<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<i class='feather' data-feather=\'info\'></i> &nbsp Solution Result 2<i class='feather-right' data-feather=\'chevron-down\'></i>",
            "<b>Tip 1:</b><br><br>Have a look at the URL - what could you do with it?",
            "<b>Tip 2:</b><br><br>Do you have any clue what the cryptic parts could mean?",
            "<b>Tip 3:</b><br><br>Are there any similarities between the cryptic parts? If yes, does they remember you of something",
            "<b>Solution Step 1:</b><br><br>If you aren´t at the Netflix.htm webpage, go there by copying the following in the URL search bar: <br><b>" + window.location.host + "/BrokenAccessControl/Vulnerable/NetflixUserChoice.htm</b><br> and hit 'Enter' afterward",
            "<b>Solution Step 2:</b><br><br>If the developer options aren´t already open, press 'F12' in your Browser to open them",
            "<b>Solution Step 3:</b><br><br>Change the section by clicking on 'Console'. Now the javascript console is opened. Type 'atob(\"\")' there (This is the javascript function to decode base64 code)",
            "<b>Solution Step 4:</b><br><br>Copy the section between the 'u=' and the '&p=' into the brackets of the 'atob'-function<br> It should now say 'atob(\"dXNlckB0ZXN0\")' in the console. Hit 'Enter' afterward.<br>You can now see the decrypted username which was encrypted in the url", 
            "<b>Solution Step 5:</b><br><br>Do the same with the section behind the 'p='. <br>The complete function should now look like this: 'atob(\"dXNlckB0ZXN0Tk3\")'. Hit 'Enter' afterward.<br>You can now see the decrypted password. Before you open the next hint, please think for a second. How could you login as admin with this information?", 
            "<b>Solution Step 6:</b><br><br>If you wanted to type 'admin' into the 'btoa' function (the javascript function for encrypting text with base64), you did everything right. Respect!", 
            "<b>Solution Step 7:</b><br><br>Type now '<b>btoa(\"admin\")</b>' into the console. You will receive the following output: 'YWRtaW4='. This is the base64 encoded version of 'admin'", 
            "<b>Solution Step 8:</b><br><br>Exchange the part between the 'u=' and the '&p=' and the part behind the 'p=' with the base64 encoded version of 'admin'. As we learned in the vulnerability '(Forgotten) Comments', we now only have to type '&check=true' behind the last letter. <br> The whole url should now look like this: <br><b>'" + window.location.host + "/BrokenAccessControl/Vulnerable/NetflixUserChoice.htm?u=YWRtaW4=&p=YWRtaW4=&check=true'</b>", 
            "<b>Solution Result 1:</b><br><br>There should appear a prompt now, which wants you to login to enter the forbidden area. This will also appear when you entered the secure website by clicking on the 'Open secure website' button, and enter on the NetflixLogin.htm website the following: as username adn password you type in 'admin'. Afterward you just have to hit 'Enter' or press the 'login'-button",
            "<b>Solution Result 2:</b><br><br>From now on the topic switches to the vulnerability 'User Misconfiguration'. If you want to advance with the exploit of the vulnerability, click in the choice-window beneath the 5th vulnerability from the left and open the 'Solution 3'"];

        var languageToUse = english;
        if (localStorage.getItem("language") === "German")
        {
            languageToUse = german;
        }

        for (var i = 0; i < 19; i++)
        {
            document.getElementById(i.toString()).innerHTML = languageToUse[i];
        }

        //Replace the icons with svgs
        feather.replace();

        var visibleElements = [];
        function showTip(element)
        {
            var index;
            if (!visibleElements.includes(element.id))
            {
                visibleElements.push(element.id);
                index = parseInt(element.id) + 13;
                element.style.textAlign = "left";
                element.style.userSelect = "auto";
            }
            else
            {
                index = visibleElements.indexOf(element.id);
                visibleElements.splice(index, index+1);
                index = element.id;
                element.style.textAlign = "center";
                element.style.userSelect = "none";
            }
            element.innerHTML = languageToUse[index];
            feather.replace();
        }
    </script>
  </body>
</html>